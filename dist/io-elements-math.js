import{IoGl,IoThemeSingleton,IoLayerSingleton}from"./io-elements-core.js";import{IoElement,html}from"./io.js";class IoVector extends IoElement{static get Style(){return html`<style>:host {display: flex;flex-direction: row;align-self: stretch;justify-self: stretch;}:host > io-number {width: inherit;flex: 1 1;}:host > *:not(:last-child) {margin-right: var(--io-spacing);}:host > io-boolean {width: var(--io-line-height) !important;}</style>`}static get Properties(){return{value:[0,0,0,0],conversion:1,step:.001,min:-1/0,max:1/0,linkable:!1,linked:!1,components:{type:Array,notify:!1}}}_onValueSet(e){const t=e.composedPath()[0].id,o=e.detail.value,n=e.detail.oldValue;if(this.value[t]=o,this.linked){const e=o/n;for(let s in this.components){const i=this.components[s];0===n?this.value[i]=o:i!==t&&(this.value[i]*=e)}}const s={object:this.value,property:this.linked?null:t,value:o,oldValue:n};this.dispatchEvent("object-mutated",s,!1,window)}valueChanged(){this.components=Object.keys(this.value)}changed(){const e=[];for(let t in this.components){const o=this.components[t];void 0!==this.value[o]&&e.push(["io-number",{id:o,value:this.value[o],conversion:this.conversion,step:this.step,min:this.min,max:this.max,ladder:!0,"on-value-set":this._onValueSet}])}e.push(this.getSlotted()),this.template(e)}getSlotted(){return this.linkable?["io-boolean",{display:"icon",value:this.bind("linked"),trueicon:"icons:link",falseicon:"icons:unlink"}]:null}}IoVector.Register();class IoMatrix extends IoElement{static get Style(){return html`<style>:host {display: grid;align-self: stretch;justify-self: stretch;grid-gap: var(--io-spacing);}:host[columns="4"] {grid-template-columns: repeat(4, 1fr);}:host[columns="3"] {grid-template-columns: repeat(3, 1fr);}:host[columns="2"] {grid-template-columns: repeat(2, 1fr);}:host > io-number {width: inherit;}</style>`}static get Attributes(){return{columns:4}}static get Properties(){return{value:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],step:.001,components:{type:Array,notify:!1}}}_onValueSet(e){if(e.detail.object)return;const t=e.composedPath()[0].id,o=e.detail.value,n=e.detail.oldValue;this.value[t]=o;const s={object:this.value,property:t,value:o,oldValue:n};this.dispatchEvent("object-mutated",s,!1,window)}valueChanged(){let e;4===this.value.length&&(e=[0,1,2,3],this.columns=2),9===this.value.length&&(e=[0,1,2,3,4,5,6,7,8],this.columns=3),16===this.value.length&&(e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],this.columns=4),this.components=e}changed(){const e=[];for(let t in this.components){const o=this.components[t];void 0!==this.value[o]&&e.push(["io-number",{id:o,value:this.value[o],step:this.step,"on-value-set":this._onValueSet}])}this.template(e)}}IoMatrix.Register();
/**@License
 * Copyright (c) 2011-2016 Heather Arthur <fayearthur@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
const convert={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(const e of Object.keys(convert)){if(!("channels"in convert[e]))throw new Error("missing channels property: "+e);if(!("labels"in convert[e]))throw new Error("missing channel labels property: "+e);if(convert[e].labels.length!==convert[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:o}=convert[e];delete convert[e].channels,delete convert[e].labels,Object.defineProperty(convert[e],"channels",{value:t}),Object.defineProperty(convert[e],"labels",{value:o})}convert.rgb.hsl=function(e){const t=e[0]/255,o=e[1]/255,n=e[2]/255,s=Math.min(t,o,n),i=Math.max(t,o,n),r=i-s;let l,a;i===s?l=0:t===i?l=(o-n)/r:o===i?l=2+(n-t)/r:n===i&&(l=4+(t-o)/r),(l=Math.min(60*l,360))<0&&(l+=360);const h=(s+i)/2;return[l,100*(a=i===s?0:h<=.5?r/(i+s):r/(2-i-s)),100*h]},convert.rgb.hsv=function(e){let t,o,n,s,i;const r=e[0]/255,l=e[1]/255,a=e[2]/255,h=Math.max(r,l,a),c=h-Math.min(r,l,a),v=function(e){return(h-e)/6/c+.5};return 0===c?(s=0,i=0):(i=c/h,t=v(r),o=v(l),n=v(a),r===h?s=n-o:l===h?s=1/3+t-n:a===h&&(s=2/3+o-t),s<0?s+=1:s>1&&(s-=1)),[360*s,100*i,100*h]},convert.rgb.hwb=function(e){const t=e[0],o=e[1];let n=e[2];return[convert.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(o,n))),100*(n=1-1/255*Math.max(t,Math.max(o,n)))]},convert.rgb.cmyk=function(e){const t=e[0]/255,o=e[1]/255,n=e[2]/255,s=Math.min(1-t,1-o,1-n);return[100*((1-t-s)/(1-s)||0),100*((1-o-s)/(1-s)||0),100*((1-n-s)/(1-s)||0),100*s]},convert.rgb.xyz=function(e){let t=e[0]/255,o=e[1]/255,n=e[2]/255;return[100*(.4124*(t=t>.04045?((t+.055)/1.055)**2.4:t/12.92)+.3576*(o=o>.04045?((o+.055)/1.055)**2.4:o/12.92)+.1805*(n=n>.04045?((n+.055)/1.055)**2.4:n/12.92)),100*(.2126*t+.7152*o+.0722*n),100*(.0193*t+.1192*o+.9505*n)]},convert.rgb.lab=function(e){const t=convert.rgb.xyz(e);let o=t[0],n=t[1],s=t[2];return[116*(n=(n/=100)>.008856?n**(1/3):7.787*n+16/116)-16,500*((o=(o/=95.047)>.008856?o**(1/3):7.787*o+16/116)-n),200*(n-(s=(s/=108.883)>.008856?s**(1/3):7.787*s+16/116))]},convert.hsl.rgb=function(e){const t=e[0]/360,o=e[1]/100,n=e[2]/100;let s,i,r;if(0===o)return[r=255*n,r,r];const l=2*n-(s=n<.5?n*(1+o):n+o-n*o),a=[0,0,0];for(let e=0;e<3;e++)(i=t+1/3*-(e-1))<0&&i++,i>1&&i--,r=6*i<1?l+6*(s-l)*i:2*i<1?s:3*i<2?l+(s-l)*(2/3-i)*6:l,a[e]=255*r;return a},convert.hsl.hsv=function(e){const t=e[0];let o=e[1]/100,n=e[2]/100,s=o;const i=Math.max(n,.01);return o*=(n*=2)<=1?n:2-n,s*=i<=1?i:2-i,[t,100*(0===n?2*s/(i+s):2*o/(n+o)),100*((n+o)/2)]},convert.hsv.rgb=function(e){const t=e[0]/60,o=e[1]/100;let n=e[2]/100;const s=Math.floor(t)%6,i=t-Math.floor(t),r=255*n*(1-o),l=255*n*(1-o*i),a=255*n*(1-o*(1-i));switch(n*=255,s){case 0:return[n,a,r];case 1:return[l,n,r];case 2:return[r,n,a];case 3:return[r,l,n];case 4:return[a,r,n];case 5:return[n,r,l]}},convert.hsv.hsl=function(e){const t=e[0],o=e[1]/100,n=e[2]/100,s=Math.max(n,.01);let i,r;r=(2-o)*n;const l=(2-o)*s;return i=o*s,[t,100*(i=(i/=l<=1?l:2-l)||0),100*(r/=2)]},convert.hwb.rgb=function(e){const t=e[0]/360;let o=e[1]/100,n=e[2]/100;const s=o+n;let i;s>1&&(o/=s,n/=s);const r=Math.floor(6*t),l=1-n;i=6*t-r,0!=(1&r)&&(i=1-i);const a=o+i*(l-o);let h,c,v;switch(r){default:case 6:case 0:h=l,c=a,v=o;break;case 1:h=a,c=l,v=o;break;case 2:h=o,c=l,v=a;break;case 3:h=o,c=a,v=l;break;case 4:h=a,c=o,v=l;break;case 5:h=l,c=o,v=a}return[255*h,255*c,255*v]},convert.cmyk.rgb=function(e){const t=e[0]/100,o=e[1]/100,n=e[2]/100,s=e[3]/100;return[255*(1-Math.min(1,t*(1-s)+s)),255*(1-Math.min(1,o*(1-s)+s)),255*(1-Math.min(1,n*(1-s)+s))]},convert.xyz.rgb=function(e){const t=e[0]/100,o=e[1]/100,n=e[2]/100;let s,i,r;return s=(s=3.2406*t+-1.5372*o+-.4986*n)>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i=(i=-.9689*t+1.8758*o+.0415*n)>.0031308?1.055*i**(1/2.4)-.055:12.92*i,r=(r=.0557*t+-.204*o+1.057*n)>.0031308?1.055*r**(1/2.4)-.055:12.92*r,[255*(s=Math.min(Math.max(0,s),1)),255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1))]},convert.xyz.lab=function(e){let t=e[0],o=e[1],n=e[2];return[116*(o=(o/=100)>.008856?o**(1/3):7.787*o+16/116)-16,500*((t=(t/=95.047)>.008856?t**(1/3):7.787*t+16/116)-o),200*(o-(n=(n/=108.883)>.008856?n**(1/3):7.787*n+16/116))]},convert.lab.xyz=function(e){let t,o,n;const s=(o=(e[0]+16)/116)**3,i=(t=e[1]/500+o)**3,r=(n=o-e[2]/200)**3;return o=s>.008856?s:(o-16/116)/7.787,t=i>.008856?i:(t-16/116)/7.787,n=r>.008856?r:(n-16/116)/7.787,[t*=95.047,o*=100,n*=108.883]},convert.lab.lch=function(e){const t=e[0],o=e[1],n=e[2];let s;return(s=360*Math.atan2(n,o)/2/Math.PI)<0&&(s+=360),[t,Math.sqrt(o*o+n*n),s]},convert.lch.lab=function(e){const t=e[0],o=e[1],n=e[2]/360*2*Math.PI;return[t,o*Math.cos(n),o*Math.sin(n)]},convert.rgb.ansi16=function(e,t=null){const[o,n,s]=e;let i=null===t?convert.rgb.hsv(e)[2]:t;if(0===(i=Math.round(i/50)))return 30;let r=30+(Math.round(s/255)<<2|Math.round(n/255)<<1|Math.round(o/255));return 2===i&&(r+=60),r},convert.hsv.ansi16=function(e){return convert.rgb.ansi16(convert.hsv.rgb(e),e[2])},convert.rgb.ansi256=function(e){const t=e[0],o=e[1],n=e[2];return t===o&&o===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(o/255*5)+Math.round(n/255*5)},convert.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];const o=.5*(1+~~(e>50));return[(1&t)*o*255,(t>>1&1)*o*255,(t>>2&1)*o*255]},convert.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;return e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},convert.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},convert.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let o=t[0];3===t[0].length&&(o=o.split("").map(e=>e+e).join(""));const n=parseInt(o,16);return[n>>16&255,n>>8&255,255&n]},convert.rgb.hcg=function(e){const t=e[0]/255,o=e[1]/255,n=e[2]/255,s=Math.max(Math.max(t,o),n),i=Math.min(Math.min(t,o),n),r=s-i;let l,a;return a=r<=0?0:s===t?(o-n)/r%6:s===o?2+(n-t)/r:4+(t-o)/r+4,a/=6,[360*(a%=1),100*r,100*(l=r<1?i/(1-r):0)]},convert.hsl.hcg=function(e){const t=e[1]/100,o=e[2]/100,n=o<.5?2*t*o:2*t*(1-o);let s=0;return n<1&&(s=(o-.5*n)/(1-n)),[e[0],100*n,100*s]},convert.hsv.hcg=function(e){const t=e[1]/100,o=e[2]/100,n=t*o;let s=0;return n<1&&(s=(o-n)/(1-n)),[e[0],100*n,100*s]},convert.hcg.rgb=function(e){const t=e[0]/360,o=e[1]/100,n=e[2]/100;if(0===o)return[255*n,255*n,255*n];const s=[0,0,0],i=t%1*6,r=i%1,l=1-r;let a=0;switch(Math.floor(i)){case 0:s[0]=1,s[1]=r,s[2]=0;break;case 1:s[0]=l,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=r;break;case 3:s[0]=0,s[1]=l,s[2]=1;break;case 4:s[0]=r,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=l}return a=(1-o)*n,[255*(o*s[0]+a),255*(o*s[1]+a),255*(o*s[2]+a)]},convert.hcg.hsv=function(e){const t=e[1]/100,o=t+e[2]/100*(1-t);let n=0;return o>0&&(n=t/o),[e[0],100*n,100*o]},convert.hcg.hsl=function(e){const t=e[1]/100,o=e[2]/100*(1-t)+.5*t;let n=0;return o>0&&o<.5?n=t/(2*o):o>=.5&&o<1&&(n=t/(2*(1-o))),[e[0],100*n,100*o]},convert.hcg.hwb=function(e){const t=e[1]/100,o=t+e[2]/100*(1-t);return[e[0],100*(o-t),100*(1-o)]},convert.hwb.hcg=function(e){const t=e[1]/100,o=1-e[2]/100,n=o-t;let s=0;return n<1&&(s=(o-n)/(1-n)),[e[0],100*n,100*s]},convert.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},convert.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},convert.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},convert.gray.hsl=function(e){return[0,0,e[0]]},convert.gray.hsv=convert.gray.hsl,convert.gray.hwb=function(e){return[0,100,e[0]]},convert.gray.cmyk=function(e){return[0,0,0,e[0]]},convert.gray.lab=function(e){return[e[0],0,0]},convert.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),o=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(o.length)+o},convert.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};const IoColorMixin=e=>{const t=class extends e{static get Properties(){return{value:[1,1,1,1],rgb:[1,1,1],hsv:[1,1,1],hsl:[1,1,1],cmyk:[1,1,1,1],alpha:1,components:{type:Array,notify:!1},mode:0}}valueMutated(){this.valueChanged()}modeChanged(){this.valueChanged()}valueChanged(){let e=[];if(this.value instanceof Array)for(let t=0;t<this.value.length;t++)e.push(t);else e.push(...Object.keys(this.value));let t=this.mode;-1!==e.indexOf("r")?t=0:-1!==e.indexOf("h")&&-1!==e.indexOf("v")?t=1:-1!==e.indexOf("h")&&-1!==e.indexOf("l")?t=2:-1!==e.indexOf("c")&&(t=3);const o=[];for(let t=0;t<e.length;t++)o.push(this.value[e[t]]);let n,s,i,r,l=void 0;switch(t){case 3:r=[100*o[0],100*o[1],100*o[2],100*o[3]],n=convert.cmyk.rgb(r),s=convert.rgb.hsv(convert.cmyk.rgb(r)),i=convert.rgb.hsl(convert.cmyk.rgb(r)),void 0!==o[4]&&(l=100*o[4]);break;case 2:i=[360*o[0],100*o[1],100*o[2]],n=convert.hsl.rgb(i),s=convert.hsl.hsv(i),r=convert.rgb.cmyk(convert.hsl.rgb(i)),void 0!==o[3]&&(l=100*o[3]);break;case 1:s=[360*o[0],100*o[1],100*o[2]],n=convert.hsv.rgb(s),i=convert.hsv.hsl(s),r=convert.rgb.cmyk(convert.hsv.rgb(s)),void 0!==o[3]&&(l=100*o[3]);break;case 0:default:n=[255*o[0],255*o[1],255*o[2]],s=convert.rgb.hsv(n),i=convert.rgb.hsl(n),r=convert.rgb.cmyk(n),void 0!==o[3]&&(l=100*o[3])}this.setProperties({rgb:[n[0]/255,n[1]/255,n[2]/255],hsv:[s[0]/360,s[1]/100,s[2]/100],hsl:[i[0]/360,i[1]/100,i[2]/100],cmyk:[r[0]/100,r[1]/100,r[2]/100,r[3]/100],alpha:void 0!==l?l/100:void 0,components:e,mode:t})}};return t.Register=IoElement.Register,t};class IoColorSwatch extends(IoColorMixin(IoGl)){static get Style(){return html`<style>:host {border-radius: var(--io-border-radius);border: var(--io-inset-border);min-width: var(--io-line-height);min-height: var(--io-line-height);}:host[aria-invalid] {border: var(--io-border-error);}:host:focus {outline: 0;border-color: var(--io-color-focus);}</style>`}static get GlUtils(){return"\n    vec3 hue2rgb(float hue) {\n      hue=fract(hue);\n      float R = abs(hue * 6. - 3.) - 1.;\n      float G = 2. - abs(hue * 6. - 2.);\n      float B = 2. - abs(hue * 6. - 4.);\n      return saturate(vec3(R,G,B));\n    }\n    vec3 hsv2rgb(vec3 hsv) {\n      vec3 rgb = hue2rgb(hsv.r);\n      return ((rgb - 1.) * hsv.g + 1.) * hsv.b;\n    }\n    vec3 hsl2rgb(vec3 hsl) {\n      vec3 rgb = hue2rgb(hsl.x);\n      float C = (1. - abs(2. * hsl.z - 1.)) * hsl.y;\n      return (rgb - 0.5) * C + hsl.z;\n    }\n    \n\n"}static get Frag(){return"\n      varying vec2 vUv;\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // Alpha pattern\n        vec3 alphaPattern = mix(vec3(0.5), vec3(1.0), checker(position, 5.0));\n\n        float alpha = uAlpha;\n        float lineWidth = cssStrokeWidth * 2.0;\n        vec2 pxUv = vUv * uSize;\n        if (pxUv.x < lineWidth) alpha = 1.0;\n        if (pxUv.y < lineWidth) alpha = 1.0;\n        if (pxUv.x > uSize.x - lineWidth) alpha = 1.0;\n        if (pxUv.y > uSize.y - lineWidth) alpha = 1.0;\n\n        gl_FragColor = saturate(vec4(mix(alphaPattern, uRgb.rgb, alpha), 1.0));\n      }\n    "}}IoColorSwatch.Register();class IoColorSlider extends IoColorSwatch{static get Style(){return html`<style>:host {cursor: ns-resize;}:host[horizontal] {cursor: ew-resize;}</style>`}static get Attributes(){return{role:"slider",tabindex:0}}static get Properties(){return{horizontal:{value:!1,reflect:1}}}static get GlUtils(){return"\n    vec2 translateSlider(vec2 position, vec2 value) {\n      float posX = uSize.x * ((uHorizontal == 1) ? value.x : value.y);\n      float posY = uSize.y * ((uHorizontal == 1) ? value.y : value.x);\n      return translate(position, posX, posY);\n    }\n    vec2 repeatX(vec2 position) {\n      float x = min(mod(uSize.x + position.x, uSize.x), mod(uSize.x - position.x, uSize.x));\n      return vec2(x, position.y);\n    }\n    vec2 repeatY(vec2 position) {\n      float y = min(mod(uSize.y + position.y, uSize.y), mod(uSize.y - position.y, uSize.y));\n      return vec2(position.x, y);\n    }\n    vec4 paintSlider(vec2 position, vec3 color) {\n      vec4 sliderColor = vec4(0.0);\n      float radius = cssItemHeight / 5.0;\n      float stroke = cssStrokeWidth;\n      vec2 width = (uHorizontal == 1) ? vec2(stroke * 2.0, uSize.y) : vec2(uSize.x, stroke * 2.0);\n      float strokeShape = min(rectangle(position, width + vec2(stroke)), circle(position, radius + stroke));\n      sliderColor = mix(vec4(cssColor.rgb, 1.0), sliderColor, strokeShape);\n      float fillShape = min(rectangle(position, width), circle(position, radius));\n      sliderColor = mix(vec4(cssBackgroundColor.rgb, 1.0), sliderColor, fillShape);\n      float colorShape = min(rectangle(position, width - vec2(stroke)), circle(position, radius - stroke));\n      sliderColor = mix(vec4(color, 1.0), sliderColor, colorShape);\n      return sliderColor;\n    }\n    vec4 paintSlider2D(vec2 position, vec3 color) {\n      vec4 sliderColor = vec4(0.0);\n      float radius = cssItemHeight / 5.0;\n      float stroke = cssStrokeWidth;\n      vec2 width = (uHorizontal == 1) ? vec2(stroke * 2.0, uSize.y) : vec2(uSize.x, stroke * 2.0);\n      float strokeShape = circle(position, radius + stroke);\n      sliderColor = mix(vec4(cssColor.rgb, 1.0), sliderColor, strokeShape);\n      float fillShape = circle(position, radius);\n      sliderColor = mix(vec4(cssBackgroundColor.rgb, 1.0), sliderColor, fillShape);\n      float colorShape = circle(position, radius - stroke);\n      sliderColor = mix(vec4(color, 1.0), sliderColor, colorShape);\n      return sliderColor;\n    }\n    \n\n"}static get Listeners(){return{touchstart:"_onTouchstart",mousedown:"_onMousedown",keydown:"_onKeydown"}}_onTouchstart(e){e.preventDefault(),this.addEventListener("touchmove",this._onTouchmove),this.addEventListener("touchend",this._onTouchend),this._onPointerdown(e),this.focus()}_onTouchmove(e){e.preventDefault(),this._onPointermove(e)}_onTouchend(){this.removeEventListener("touchmove",this._onTouchmove),this.removeEventListener("touchend",this._onTouchend)}_onMousedown(e){e.preventDefault(),this.focus(),window.addEventListener("mousemove",this._onMousemove),window.addEventListener("mouseup",this._onMouseup),this._onPointerdown(e)}_onMousemove(e){this._onPointermove(e)}_onMouseup(){window.removeEventListener("mousemove",this._onMousemove),window.removeEventListener("mouseup",this._onMouseup)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("mousemove",this._onMousemove),window.removeEventListener("mouseup",this._onMouseup)}_onPointerdown(e){this._onPointermove(e)}_onPointermoveDebounced(e){const t=e.changedTouches?e.changedTouches[0]:e,o=this.getBoundingClientRect(),n=Math.max(0,Math.min(1,(t.clientX-o.x)/o.width)),s=Math.max(0,Math.min(1,(t.clientY-o.y)/o.height));this._setValue(n,s),this.dispatchEvent("object-mutated",{object:this.value},!1,window),this.dispatchEvent("value-set",{property:"value",value:this.value},!1),this.valueChanged(),this.changed()}_onPointermove(e){this.debounce(this._onPointermoveDebounced,e)}_setValue(e,t){}}IoColorSlider.Register();class IoColorSliderHue extends IoColorSlider{static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // Hue spectrum\n        float axis = (uHorizontal == 1) ? vUv.x : vUv.y;\n        vec3 finalColor = hsv2rgb(vec3(axis, uHsv[1], uHsv[2]));\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(uHsv[0], 0.5));\n        markerPos = (uHorizontal == 1) ? repeatX(markerPos) : repeatY(markerPos);\n        vec4 slider = paintSlider(markerPos, uRgb);\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?e:1-t));switch(this.mode){case 0:{this.hsv[0]=o;const e=convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{this.hsv[0]=o;const e=convert.rgb.cmyk(convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:case 2:this.value[this.components[0]]=o}}}IoColorSliderHue.Register();class IoColorSliderSaturation extends IoColorSlider{static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // Saturation gradient\n        float axis = (uHorizontal == 1) ? vUv.x : vUv.y;\n        vec3 finalColor = hsv2rgb(vec3(uHsv[0], axis, uHsv[2]));\n        float saturation = uHsv[1];\n        if (uMode == 2.0) {\n          saturation = uHsl[1];\n          finalColor = hsl2rgb(vec3(uHsl[0], axis, uHsl[2]));\n        }\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(saturation, 0.5));\n        vec4 slider = paintSlider(markerPos, uRgb);\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?e:1-t));switch(this.mode){case 0:{this.hsv[1]=o;const e=convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{this.hsv[1]=o;const e=convert.rgb.cmyk(convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:case 2:this.value[this.components[1]]=o}}}IoColorSliderSaturation.Register();class IoColorSliderValue extends IoColorSlider{static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // Value gradient\n        float axis = (uHorizontal == 1) ? vUv.x : vUv.y;\n        vec3 finalColor = hsv2rgb(vec3(uHsv[0], uHsv[1], axis));\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(uHsv[2], 0.5));\n        vec4 slider = paintSlider(markerPos, uRgb);\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?e:1-t));switch(this.mode){case 0:{this.hsv[2]=o;const e=convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{this.hsv[2]=o;const e=convert.rgb.cmyk(convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:this.value[this.components[2]]=o;break;case 2:{this.hsv[2]=o;const e=convert.rgb.hsl(convert.hsv.rgb([100*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100;break}}}}IoColorSliderValue.Register();class IoColorSliderLevel extends IoColorSlider{static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // Value gradient\n        float axis = (uHorizontal == 1) ? vUv.x : vUv.y;\n        vec3 finalColor = hsl2rgb(vec3(uHsl[0], uHsl[1], axis));\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(uHsl[2], 0.5));\n        vec4 slider = paintSlider(markerPos, uRgb);\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?e:1-t));switch(this.mode){case 0:{this.hsl[2]=o;const e=convert.hsl.rgb([360*this.hsl[0],100*this.hsl[1],100*this.hsl[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{this.hsl[2]=o;const e=convert.rgb.cmyk(convert.hsl.rgb([360*this.hsl[0],100*this.hsl[1],100*this.hsl[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:{this.hsl[2]=o;const e=convert.rgb.hsv(convert.hsl.rgb([100*this.hsl[0],100*this.hsl[1],100*this.hsl[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100;break}case 2:this.value[this.components[2]]=o}}}IoColorSliderLevel.Register();class IoColorSliderHs extends IoColorSlider{static get Style(){return html`<style>:host {cursor: move !important;}</style>`}static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // HS gradient\n        vec2 axis = (uHorizontal == 1) ? vec2(vUv.y, vUv.x) : vec2(vUv.x, vUv.y);\n        vec3 finalColor = hsv2rgb(vec3(axis, uHsv[2]));\n        float saturation = uHsv[1];\n        if (uMode == 2.0) {\n          saturation = uHsl[1];\n          finalColor = hsl2rgb(vec3(axis, uHsl[2]));\n        }\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(uHsv[1], uHsv[0]));\n        markerPos = (uHorizontal == 1) ? repeatY(markerPos) : repeatX(markerPos);\n        vec4 slider = paintSlider2D(markerPos, uRgb);\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?1-t:e)),n=Math.max(0,Math.min(1,this.horizontal?e:1-t));switch(this.mode){case 0:{this.hsv[0]=o,this.hsv[1]=n;const e=convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{this.hsv[0]=o,this.hsv[1]=n;const e=convert.rgb.cmyk(convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:case 2:this.value[this.components[0]]=o,this.value[this.components[1]]=n}}}IoColorSliderHs.Register();class IoColorSliderSv extends IoColorSlider{static get Style(){return html`<style>:host {cursor: move !important;}</style>`}static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // SV gradient\n        vec2 axis = (uHorizontal == 1) ? vec2(vUv.y, vUv.x) : vec2(vUv.x, vUv.y);\n        vec3 finalColor = hsv2rgb(vec3(uHsv[0], axis.x, axis.y));\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(uHsv[2], uHsv[1]));\n        vec4 slider = paintSlider2D(markerPos, uRgb);\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?1-t:e)),n=Math.max(0,Math.min(1,this.horizontal?e:1-t));switch(this.mode){case 0:{this.hsv[1]=o,this.hsv[2]=n;const e=convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{this.hsv[1]=o,this.hsv[2]=n;const e=convert.rgb.cmyk(convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:this.value[this.components[1]]=o,this.value[this.components[2]]=n;break;case 2:{this.hsv[1]=o,this.hsv[2]=n;const e=convert.rgb.hsl(convert.hsv.rgb([100*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100;break}}}}IoColorSliderSv.Register();class IoColorSliderSl extends IoColorSlider{static get Style(){return html`<style>:host {cursor: move !important;}</style>`}static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // SV gradient\n        vec2 axis = (uHorizontal == 1) ? vec2(vUv.y, vUv.x) : vec2(vUv.x, vUv.y);\n        vec3 finalColor = hsl2rgb(vec3(uHsl[0], axis.x, axis.y));\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(uHsl[2], uHsl[1]));\n        vec4 slider = paintSlider2D(markerPos, uRgb);\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?1-t:e)),n=Math.max(0,Math.min(1,this.horizontal?e:1-t));switch(this.mode){case 0:{this.hsl[1]=o,this.hsl[2]=n;const e=convert.hsl.rgb([360*this.hsl[0],100*this.hsl[1],100*this.hsl[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{this.hsl[1]=o,this.hsl[2]=n;const e=convert.rgb.cmyk(convert.hsl.rgb([360*this.hsl[0],100*this.hsl[1],100*this.hsl[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:{this.hsl[1]=o,this.hsl[2]=n;const e=convert.rgb.hsv(convert.hsl.rgb([100*this.hsl[0],100*this.hsl[1],100*this.hsl[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100;break}case 2:this.value[this.components[1]]=o,this.value[this.components[2]]=n}}}IoColorSliderSl.Register();class IoColorSliderAlpha extends IoColorSlider{static get Frag(){return"\n      varying vec2 vUv;\n\n      void main(void) {\n        vec2 position = vUv * uSize;\n\n        // Alpha pattern\n        vec3 alphaPattern = mix(vec3(0.5), vec3(1.0), checker(position, 5.0));\n        vec3 finalColor = alphaPattern;\n\n        // Apha gradient\n        float axis = (uHorizontal == 1) ? vUv.x : vUv.y;\n        finalColor = mix(finalColor, vec3(1.0), axis);\n\n        // Marker\n        vec2 markerPos = translateSlider(position, vec2(uAlpha, 0.5));\n        vec4 slider = paintSlider(markerPos, vec3(1.0));\n        finalColor = mix(finalColor, slider.rgb, slider.a);\n\n        gl_FragColor = vec4(finalColor, 1.0);\n      }\n    "}valueChanged(){super.valueChanged();const e=void 0!==this.value[this.components[3]];this.setAttribute("aria-invalid",!e&&"true")}_setValue(e,t){this.valueChanged();const o=Math.max(0,Math.min(1,this.horizontal?e:1-t)),n=3===this.mode?4:3;void 0!==this.value[this.components[n]]&&(this.value[this.components[n]]=o)}}IoColorSliderAlpha.Register();class IoColorPanel extends(IoColorMixin(IoElement)){static get Style(){return html`<style>:host {${IoThemeSingleton.panel}}:host {display: flex;cursor: move;align-items: stretch;min-width: var(--io-line-height);min-height: var(--io-line-height);flex-direction: column;}:host[horizontal] {flex-direction: row;}:host > io-color-slider-sv {flex: 1 1;}:host > *:not(:last-child) {margin: 0 0 var(--io-spacing) 0;}:host[horizontal] > *:not(:last-child) {margin: 0 var(--io-spacing) 0 0;}</style>`}static get Attributes(){return{horizontal:!0}}static get Properties(){return{expanded:{type:Boolean,reflect:1}}}_onHsvSet(){switch(this.mode){case 0:{const e=convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]);this.value[this.components[0]]=e[0]/255,this.value[this.components[1]]=e[1]/255,this.value[this.components[2]]=e[2]/255;break}case 3:{const e=convert.rgb.cmyk(convert.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100,this.value[this.components[3]]=e[3]/100;break}case 1:this.value[this.components[0]]=this.hsv[0],this.value[this.components[1]]=this.hsv[1],this.value[this.components[2]]=this.hsv[2];break;case 2:{const e=convert.rgb.hsl(convert.hsv.rgb([100*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]));this.value[this.components[0]]=e[0]/100,this.value[this.components[1]]=e[1]/100,this.value[this.components[2]]=e[2]/100;break}}this._suspendLoop=!0,this.dispatchEvent("object-mutated",{object:this.value},!1,window),setTimeout(()=>{this._suspendLoop=!1})}expandedChanged(){this.valueChanged()}changed(){this.template([["io-color-slider-sv",{value:this.hsv,mode:1,"on-value-set":this._onHsvSet}],["io-color-slider-hue",{value:this.hsv,mode:1,horizontal:!this.horizontal,"on-value-set":this._onHsvSet}],void 0!==this.alpha?["io-color-slider-alpha",{value:this.value,horizontal:!this.horizontal}]:null])}}IoColorPanel.Register();const IoColorPanelSingleton=new IoColorPanel;IoLayerSingleton.appendChild(IoColorPanelSingleton),IoColorPanelSingleton.addEventListener("expanded-changed",IoLayerSingleton.onChildExpanded);class IoColorPicker extends IoColorSwatch{static get Attributes(){return{role:"slider",tabindex:0}}static get Properties(){return{value:[.5,.5,.5,.5],horizontal:!1}}static get Listeners(){return{mousedown:"_onMousedown",keydown:"_onKeydown"}}_onMousedown(){event.preventDefault(),this.focus(),this._expand()}_onKeydown(){this._expand()}_expand(){const e=void 0!==this.alpha;IoColorPanelSingleton.value=this.value,IoColorPanelSingleton.mode=this.mode,IoColorPanelSingleton.style.width=e?"192px":"160px",IoColorPanelSingleton.style.height="128px",IoColorPanelSingleton.expanded=!0,IoLayerSingleton.clickblock=!0,IoLayerSingleton.srcElement=this,IoLayerSingleton.setElementPosition(IoColorPanelSingleton,"bottom",this.getBoundingClientRect())}}IoColorPicker.Register();class IoColorVector extends(IoColorMixin(IoVector)){static get Style(){return html`<style>:host > io-color-picker {width: calc(var(--io-line-height) + calc(2 * var(--io-spacing)));}</style>`}static get Properties(){return{min:0,max:1,step:.01}}getSlotted(){return["io-color-picker",{id:"swatch",mode:this.mode,value:this.value}]}}IoColorVector.Register();export{IoColorPanel,IoColorPicker,IoColorSlider,IoColorSliderAlpha,IoColorSliderHs,IoColorSliderHue,IoColorSliderLevel,IoColorSliderSaturation,IoColorSliderSl,IoColorSliderSv,IoColorSliderValue,IoColorVector,IoMatrix,IoVector};