class NodeBindings{constructor(e){Object.defineProperty(this,"node",{value:e,configurable:!0})}get(e){return this[e]=this[e]||new Binding(this.node,e),this[e]}dispose(){for(let e in this)this[e].dispose(),delete this[e];delete this.node}}class Binding{constructor(e,t){this.source=e,this.sourceProp=t,this.targets=[],this.targetsMap=new WeakMap,this._onTargetChanged=this._onTargetChanged.bind(this),this._onSourceChanged=this._onSourceChanged.bind(this),this.source.addEventListener(this.sourceProp+"-changed",this._onSourceChanged)}get value(){return this.source[this.sourceProp]}addTarget(e,t){if(-1===this.targets.indexOf(e)&&this.targets.push(e),this.targetsMap.has(e)){const s=this.targetsMap.get(e);-1===s.indexOf(t)&&(s.push(t),e.addEventListener(t+"-changed",this._onTargetChanged))}else this.targetsMap.set(e,[t]),e.addEventListener(t+"-changed",this._onTargetChanged)}removeTarget(e,t){if(this.targetsMap.has(e)){const s=this.targetsMap.get(e);if(t){const n=s.indexOf(t);-1!==n&&s.splice(n,1),e.removeEventListener(t+"-changed",this._onTargetChanged)}else{for(let t=s.length;t--;)e.removeEventListener(s[t]+"-changed",this._onTargetChanged);s.length=0}0===s.length&&this.targets.splice(this.targets.indexOf(e),1)}}_onTargetChanged(e){if(-1===this.targets.indexOf(e.target))return void console.error("Io: _onTargetChanged() should never fire when target is removed from binding.\n        Please file an issue at https://github.com/arodic/io/issues.");const t=this.source[this.sourceProp],s=e.detail.value;if(t!==s){if("number"==typeof s&&isNaN(s)&&"number"==typeof t&&isNaN(t))return;this.source[this.sourceProp]=s}}_onSourceChanged(e){if(e.target!=this.source)return void console.error("Io: _onSourceChanged() should always originate form source node.\n        Please file an issue at https://github.com/arodic/io/issues.");const t=e.detail.value;for(let e=this.targets.length;e--;){const s=this.targetsMap.get(this.targets[e]);for(let n=s.length;n--;){const i=this.targets[e][s[n]];if(i!==t){if("number"==typeof t&&isNaN(t)&&"number"==typeof i&&isNaN(i))continue;this.targets[e][s[n]]=t}}}}dispose(){this.source.removeEventListener(this.sourceProp+"-changed",this._onSourceChanged);for(let e in this.targets)this.removeTarget(this.targets[e]),delete this.targets[e]}}class NodeQueue extends Array{constructor(e){super(),Object.defineProperty(this,"node",{value:e,configurable:!0})}queue(e,t,s){const n=this.indexOf(e);-1===n?this.push(e,{property:e,value:t,oldValue:s}):this[n+1].value=t}dispatch(){if(!0===this._dispatchInProgress)return;this._dispatchInProgress=!0;const e=this.node;let t=!1;for(;this.length;){const s=this.length-2,n=this[s],i=this[s+1],o={detail:i};i.value!==i.oldValue?(t=!0,e[n+"Changed"]&&e[n+"Changed"](o),e.propertyChanged&&e.propertyChanged(o),e.dispatchEvent(n+"-changed",o.detail)):i.value,this.splice(s,2)}t&&(e.applyCompose(),e.changed()),this.length=0,this._dispatchInProgress=!1}dispose(){this.length=0,delete this.node}}class ProtoListeners{constructor(e){for(let t=e.length;t--;){const s=e[t].constructor.Listeners;for(let e in s)this[e]=s[e]}}}class Listeners{constructor(e,t){Object.defineProperty(this,"node",{value:e}),Object.defineProperty(this,"propListeners",{value:{}}),Object.defineProperty(this,"activeListeners",{value:{}}),Object.defineProperty(this,"__connected",{enumerable:!1,writable:!0});for(let e in t)this[e]=t[e]}setPropListeners(e){const t=this.propListeners,s=this.node,n={};for(let t in e)t.startsWith("on-")&&(n[t.slice(3,t.length)]=e[t]);for(let e in n){if(t[e])if(t[e]instanceof Array){const n="function"==typeof t[e][0]?t[e][0]:s[t[e][0]];s.removeEventListener(e,n,t[e][1])}else{const n="function"==typeof t[e]?t[e]:s[t[e]];s.removeEventListener(e,n)}if(t[e]=n[e],this.__connected)if(n[e]instanceof Array){const t="function"==typeof n[e][0]?n[e][0]:s[n[e][0]];s.addEventListener(e,t,n[e][1])}else{const t="function"==typeof n[e]?n[e]:s[n[e]];s.addEventListener(e,t)}}}connect(){this.__connected=!0;const e=this.node,t=this.propListeners;for(let t in this)this[t]instanceof Array?this.addEventListener(t,e[this[t][0]],this[t][1]):this.addEventListener(t,e[this[t]]);for(let s in t)if(t[s]instanceof Array){const n="function"==typeof t[s][0]?t[s][0]:e[t[s][0]];this.addEventListener(s,n,t[s][1])}else{const n="function"==typeof t[s]?t[s]:e[t[s]];this.addEventListener(s,n)}}disconnect(){this.__connected=!1;const e=this.node,t=this.propListeners;for(let t in this)this[t]instanceof Array?this.removeEventListener(t,e[this[t][0]],this[t][1]):this.removeEventListener(t,e[this[t]]);for(let s in t)if(t[s]instanceof Array){const n="function"==typeof t[s][0]?t[s][0]:e[t[s][0]];this.removeEventListener(s,n,t[s][1])}else{const n="function"==typeof t[s]?t[s]:e[t[s]];this.removeEventListener(s,n)}}dispose(){this.disconnect();const e=this.activeListeners;for(let t in e)for(let s=e[t].length;s--;)this.node.isElement&&HTMLElement.prototype.removeEventListener.call(this.node,t,e[t][s]),e[t].splice(s,1)}addEventListener(e,t,s){const n=this.activeListeners;n[e]=n[e]||[],-1===n[e].indexOf(t)&&(this.node.isElement&&HTMLElement.prototype.addEventListener.call(this.node,e,t,s),n[e].push(t))}removeEventListener(e,t,s){const n=this.activeListeners;if(void 0!==n[e]){const i=n[e].indexOf(t);-1!==i&&(this.node.isElement&&HTMLElement.prototype.removeEventListener.call(this.node,e,t,s),n[e].splice(i,1))}}dispatchEvent(e,t={},s=!0,n=this.node){if(n instanceof HTMLElement||n===window)HTMLElement.prototype.dispatchEvent.call(n,new CustomEvent(e,{type:e,detail:t,bubbles:s,composed:!0,cancelable:!0}));else{const s=this.activeListeners;if(void 0!==s[e]){const i=s[e].slice(0);for(let e=0;e<i.length;e++)i[e].call(n,{detail:t,target:n,path:[n]})}}}}class ProtoProperties{constructor(e){this._p=e;const t={};for(let s=e.length;s--;){const n=e[s].constructor.Properties;for(let e in n)t[e]?Object.assign(t[e],new ProtoProperty(n[e])):t[e]=new ProtoProperty(n[e]),void 0===t[e].reflect&&(t[e].reflect=0),void 0===t[e].notify&&(t[e].notify=!0),void 0===t[e].enumerable&&(t[e].enumerable=!0)}for(let e in t){"_"===e.charAt(0)&&(t[e].notify=!1,t[e].enumerable=!1),void 0===t[e].value&&(t[e].value=void 0),void 0===t[e].type&&(t[e].type=void 0),this[e]=new Property(t[e])}}}class ProtoProperty{constructor(e){const t=typeof e;null==e?e={value:e}:"function"===t?e={type:e}:"number"===t||"string"===t||"boolean"===t?e={value:e,type:e.constructor}:"object"===t?e instanceof Array?e={value:[...e],type:Array}:e instanceof Binding?e={value:e.value,binding:e}:"function"!=typeof e.type&&(void 0===e.value||null===e.value||(e.type=e.value.constructor)):console.error("Property error!",t,e),void 0!==e.value&&(this.value=e.value),void 0!==e.type&&(this.type=e.type),void 0!==e.reflect&&(this.reflect=e.reflect),void 0!==e.notify&&(this.notify=e.notify),void 0!==e.enumerable&&(this.enumerable=e.enumerable),void 0!==e.binding&&(this.binding=e.binding)}}class Properties{constructor(e,t){Object.defineProperty(this,"node",{value:e});for(let s in t)this[s]=new Property(t[s]),this[s].instantiateCustomType(),void 0!==this[s].value&&("object"==typeof this[s].value&&null!==this[s].value?(this[s].value.isNode&&this[s].value.connect(e),e.queue(s,this[s].value,void 0)):this[s].reflect>=1&&this.node.setAttribute(s,this[s].value))}get(e){return this[e].value}set(e,t,s){let n=this[e].value;if(t!==n){let i=this[e].binding,o=t instanceof Binding?t:null;o&&i&&o!==i&&i.removeTarget(this.node,e),o?(o.addTarget(this.node,e),this[e].binding=o,this[e].value=t.source[t.sourceProp],t=t.source[t.sourceProp]):this[e].value=t,t&&t.isNode&&t.connect(this.node),n&&n.isNode&&n.disconnect(this.node),this[e].notify&&n!==this[e].value&&(this.node.queue(e,this[e].value,n),this.node.__connected&&!s&&this.node.queueDispatch()),this[e].reflect>=1&&this.node.setAttribute(e,t)}}connect(){for(let e in this)this[e].binding&&this[e].binding.addTarget(this.node,e)}disconnect(){for(let e in this)this[e].binding&&this[e].binding.removeTarget(this.node,e)}dispose(){for(let e in this)this[e].binding&&(this[e].binding.removeTarget(this.node,e),delete this[e].binding),delete this[e]}}class Property{constructor(e){this.value=e.value,this.type=e.type,this.reflect=e.reflect,this.notify=e.notify,this.enumerable=e.enumerable,this.binding=e.binding,this.type===Array&&this.value&&(this.value=[...this.value]),this.type===Object&&this.value&&(this.value={}),void 0===this.value&&this.type&&(this.type===Boolean?this.value=!1:this.type===String?this.value="":this.type===Number?this.value=0:this.type===Array?this.value=[]:this.type===Object&&(this.value={}))}instantiateCustomType(){void 0===this.value&&this.type&&this.type!==HTMLElement&&this.type!==Function&&(this.value=new this.type)}}const IoNodeMixin=e=>{const t=class extends e{static get Properties(){return{$:{type:Object,notify:!1}}}constructor(e={}){super(e),Object.defineProperty(this,"__nodeBindings",{value:new NodeBindings(this)}),Object.defineProperty(this,"__nodeQueue",{value:new NodeQueue(this)}),Object.defineProperty(this,"__properties",{value:new Properties(this,this.__protoProperties)}),Object.defineProperty(this,"__listeners",{value:new Listeners(this,this.__protoListeners)}),Object.defineProperty(this,"__connected",{enumerable:!1,writable:!0});for(let e=0;e<this.__functions.length;e++)this[this.__functions[e]]=this[this.__functions[e]].bind(this);this.setProperties(e)}connect(e){this._owner=this._owner||[],-1===this._owner.indexOf(e)&&(this._owner.push(e),this.__connected||this.connectedCallback())}disconnect(e){-1!==this._owner.indexOf(e)&&this._owner.splice(this._owner.indexOf(e),1),0===this._owner.length&&this.__connected&&this.disconnectedCallback()}preventDefault(e){e.preventDefault()}changed(){}applyCompose(){const e=this.compose;if(e)for(let t in e)this[t].setProperties(e[t])}bind(e){return this.__nodeBindings.get(e)}set(e,t,s){if(this[e]!==t||s){const s=this[e];this[e]=t,this.dispatchEvent("value-set",{property:e,value:t,oldValue:s},!1)}}setProperties(e){for(let t in e)void 0!==this.__properties[t]&&this.__properties.set(t,e[t],!0);if(e.style)for(let t in e.style)this.style[t]=e.style[t],this.style.setProperty(t,e.style[t]);this.__listeners.setPropListeners(e,this),this.__connected&&this.queueDispatch()}_onObjectMutation(e){for(let t=this.__objectProps.length;t--;){const s=this.__objectProps[t];this.__properties[s].value===e.detail.object&&this.debounce(this._onObjectMutationDebounced,s)}}_onObjectMutationDebounced(e){this.propMutated&&this.propMutated(e),this[e+"Mutated"]&&this[e+"Mutated"](),this.changed(),this.applyCompose()}connectedCallback(){this.__listeners.connect(),this.__properties.connect(),this.__connected=!0,this.__objectProps.length&&window.addEventListener("object-mutated",this._onObjectMutation),this.queueDispatch()}disconnectedCallback(){this.__listeners.disconnect(),this.__properties.disconnect(),this.__connected=!1,this.__objectProps.length&&window.removeEventListener("object-mutated",this._onObjectMutation)}dispose(){this.__nodeQueue.dispose(),this.__nodeBindings.dispose(),this.__listeners.dispose(),this.__properties.dispose()}addEventListener(e,t,s){"function"==typeof t?this.__listeners.addEventListener(e,t,s):console.warn(`Io ${this.constructor.name} "${e}" listener handler is not a function`)}removeEventListener(e,t,s){this.__listeners.removeEventListener(e,t,s)}dispatchEvent(e,t,s=!1,n){this.__listeners.dispatchEvent(e,t,s,n)}queue(e,t,s){this.__nodeQueue.queue(e,t,s)}queueDispatch(){this.__nodeQueue.dispatch()}debounce(e,t){if(-1===preDebounceQueue.indexOf(e))return preDebounceQueue.push(e),void e(t);if(-1===debounceQueue.indexOf(e)&&debounceQueue.push(e),argQueue.has(e)&&"object"!=typeof t){const s=argQueue.get(e);-1===s.indexOf(t)&&s.push(t)}else argQueue.set(e,[t])}requestAnimationFrameOnce(e){requestAnimationFrameOnce(e)}};return t.Register=Register,t},Register=function(){let e=this.prototype;const t=[];for(;e&&e.constructor!==HTMLElement&&e.constructor!==Object;)t.push(e),e=e.__proto__;Object.defineProperty(this.prototype,"isNode",{value:e.constructor!==HTMLElement}),Object.defineProperty(this.prototype,"isElement",{value:e.constructor===HTMLElement}),e=this.prototype,Object.defineProperty(e,"__protochain",{value:t}),Object.defineProperty(e,"__protoProperties",{value:new ProtoProperties(t)}),Object.defineProperty(e,"__protoListeners",{value:new ProtoListeners(t)});const s=new Set;for(let e=t.length;e--;){const n=Object.getOwnPropertyNames(t[e]);for(let i=0;i<n.length;i++){if("constructor"===n[i])continue;const o=Object.getOwnPropertyDescriptor(t[e],n[i]);o.get||o.set||"function"==typeof t[e][n[i]]&&(n[i].startsWith("_")||n[i].startsWith("on"))&&s.add(n[i])}}Object.defineProperty(e,"__functions",{value:[...s]}),Object.defineProperty(e,"__objectProps",{value:[]});const n=[Boolean,String,Number,HTMLElement,Function,void 0];for(let t in e.__protoProperties){const s=e.__protoProperties[t];s.notify&&-1==n.indexOf(s.type)&&e.__objectProps.push(t)}for(let t in e.__protoProperties)Object.defineProperty(e,t,{get:function(){return this.__properties.get(t)},set:function(e){this.__properties.set(t,e)},enumerable:!!e.__protoProperties[t].enumerable,configurable:!0})};IoNodeMixin.Register=Register;const preDebounceQueue=new Array,debounceQueue=new Array,argQueue=new WeakMap,funcQueue=new Array,animate=function(){requestAnimationFrame(animate);for(let e=preDebounceQueue.length;e--;)preDebounceQueue.splice(preDebounceQueue.indexOf(preDebounceQueue[e]),1);for(let e=debounceQueue.length;e--;){const t=argQueue.get(debounceQueue[e]);for(let s=t.length;s--;)debounceQueue[e](t[s]),t.splice(t.indexOf(s),1);debounceQueue.splice(debounceQueue.indexOf(debounceQueue[e]),1)}for(let e=funcQueue.length;e--;){const t=funcQueue[e];funcQueue.splice(funcQueue.indexOf(t),1),t()}};function requestAnimationFrameOnce(e){-1===funcQueue.indexOf(e)&&funcQueue.push(e)}requestAnimationFrame(animate);class IoNode extends(IoNodeMixin(Object)){}
/** @license
 * MIT License
 *
 * Copyright (c) 2019 Luke Jackson
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const isString=e=>"string"==typeof e,isArray=Array.isArray,isObject=e=>"object"==typeof e&&!isArray(e),clense=(e,t)=>t?isString(t[0])?[...e,t]:[...e,...t]:e,buildTree=()=>e=>e&&isObject(e[1])?{name:e[0],props:e[1],children:isArray(e[2])?e[2].reduce(clense,[]).map(buildTree()):e[2]||""}:buildTree()([e[0],{},e[1]||""]);class IoElement extends(IoNodeMixin(HTMLElement)){static get Properties(){return{tabindex:{type:String,reflect:1},contenteditable:{type:Boolean,reflect:1},class:{type:String,reflect:1},role:{type:String,reflect:1},label:{type:String,reflect:1},id:{type:String,reflect:-1}}}static get Listeners(){return{"focus-to":"_onFocusTo"}}static get observedAttributes(){const e=[];for(let t in this.prototype.__protoProperties){const s=this.prototype.__protoProperties[t].reflect;-1!==s&&2!==s||e.push(t)}return e}attributeChangedCallback(e,t,s){const n=this.__properties[e].type;n===Boolean?null===s?this[e]=!1:""===s&&(this[e]=!0):n===Number||n===String?this[e]=n(s):n===Object||n===Array?this[e]=JSON.parse(s):this[e]=isNaN(Number(s))?s:Number(s)}connectedCallback(){super.connectedCallback(),"function"==typeof this.onResized&&(ro?ro.observe(this):(window.addEventListener("resize",this.onResized),setTimeout(()=>{this.onResized()})))}disconnectedCallback(){super.disconnectedCallback(),"function"==typeof this.onResized&&(ro?ro.unobserve(this):window.removeEventListener("resize",this.onResized))}template(e,t){const s=buildTree()(["root",e]).children;t===this&&(this.__properties.$.value={}),this.traverse(s,t||this)}traverse(e,t){const s=t.children;for(focusBacktrack=new WeakMap;s.length>e.length;){const e=s[s.length-1];t.removeChild(e)}if(s.length<e.length){const n=document.createDocumentFragment();for(let t=s.length;t<e.length;t++)n.appendChild(constructElement(e[t]));t.appendChild(n)}for(let n=0;n<s.length;n++)if(s[n].localName!==e[n].name){const i=s[n];t.insertBefore(constructElement(e[n]),i),t.removeChild(i)}else s[n].removeAttribute("className"),Object.prototype.hasOwnProperty.call(s[n],"__properties")?s[n].setProperties(e[n].props):setNativeElementProps(s[n],e[n].props);for(let t=0;t<e.length;t++)e[t].props.id&&(this.$[e[t].props.id]=s[t]),e[t].children&&("string"==typeof e[t].children?(this.flattenTextNode(s[t]),s[t]._textNode.nodeValue=String(e[t].children)):"object"==typeof e[t].children&&this.traverse(e[t].children,s[t]))}flattenTextNode(e){if(0===e.childNodes.length&&e.appendChild(document.createTextNode("")),"#text"!==e.childNodes[0].nodeName&&(e.innerHTML="",e.appendChild(document.createTextNode(""))),e._textNode=e.childNodes[0],e.childNodes.length>1){const t=e.textContent;for(let t=e.childNodes.length;t--;)0!==t&&e.removeChild(e.childNodes[t]);e._textNode.nodeValue=t}}setAttribute(e,t){!0===t?HTMLElement.prototype.setAttribute.call(this,e,""):!1===t||""===t?this.removeAttribute(e):"string"!=typeof t&&"number"!=typeof t||this.getAttribute(e)!==String(t)&&HTMLElement.prototype.setAttribute.call(this,e,t)}_onFocusTo(e){const t=e.composedPath()[0];if(t!==this){const s=e.detail.dir,n=e.detail.rect;let i=t,o=1/0;const r=focusBacktrack.get(t);if(r&&r[s])return r[s].focus(),void setBacktrack(r[s],s,t);const c=this.querySelectorAll('[tabindex="0"]');for(let e=c.length;e--;){if(!c[e].offsetParent)continue;if("visible"!==window.getComputedStyle(c[e]).visibility)continue;const t=c[e].getBoundingClientRect();t.center={x:t.x+t.width/2,y:t.y+t.height/2};const r=t.center.x-n.center.x,a=t.center.y-n.center.y,h=t.right>n.right+1,l=t.left<n.left-1,d=t.center.y>n.center.y+1,u=t.center.y<n.center.y-1,p=Math.sqrt(.2*r*r+a*a),f=Math.sqrt(r*r+.2*a*a);switch(s){case"right":r>0&&f<o&&h&&(i=c[e],o=f);break;case"left":r<0&&f<o&&l&&(i=c[e],o=f);break;case"down":a>0&&p<o&&d&&(i=c[e],o=p);break;case"up":a<0&&p<o&&u&&(i=c[e],o=p)}}i!==t&&(i.focus(),setBacktrack(i,s,t),e.stopImmediatePropagation())}}focusTo(e){const t=this.getBoundingClientRect();t.center={x:t.x+t.width/2,y:t.y+t.height/2},this.dispatchEvent("focus-to",{dir:e,rect:t},!0)}}let focusBacktrack=new WeakMap;const backtrackDir={left:"right",right:"left",down:"up",up:"down"};function setBacktrack(e,t,s){const n=focusBacktrack.get(e)||{};n[backtrackDir[t]]=s,focusBacktrack.set(e,n)}const warning=document.createElement("div");let ro;function html(e){let t="";for(let s=0;s<e.length;s++)t+=e[s]+(arguments[s+1]||"");return t=(t=t.replace(new RegExp("<style>","g"),"")).replace(new RegExp("</style>","g"),"")}warning.innerHTML='\nNo support for custom elements detected! <br />\nSorry, modern browser is required to view this page.<br />\nPlease try <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a>,\n<a href="https://www.google.com/chrome/">Chrome</a> or\n<a href="https://www.apple.com/lae/safari/">Safari</a>',IoElement.Register=function(){IoNodeMixin.Register.call(this),IoElement.isIoElement=!0;const e=this.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();Object.defineProperty(this,"localName",{value:e}),Object.defineProperty(this.prototype,"localName",{value:e}),void 0!==window.customElements?(window.customElements.define(e,this),_initProtoStyle(this.prototype.__protochain)):document.body.insertBefore(warning,document.body.children[0])},void 0!==window.ResizeObserver&&(ro=new ResizeObserver(e=>{for(let t of e)t.target.onResized()}));const constructElement=function(e){const t=window.customElements?window.customElements.get(e.name):null;if(t&&t.isIoElement)return new t(e.props);const s=document.createElement(e.name);return setNativeElementProps(s,e.props),s},superCreateElement=document.createElement;document.createElement=function(){const e=arguments[0];if(e.startsWith("io-")){const t=customElements.get(e);return t?new t:superCreateElement.apply(this,arguments)}return superCreateElement.apply(this,arguments)};const setNativeElementProps=function(e,t){for(let s in t){const n=t[s];if(s.startsWith("@"))e.setAttribute(s.substr(1),n);else if("style"===s)for(let t in n)e.style.setProperty(t,n[t]);else"class"===s?e.className=n:"id"!==s&&(e[s]=n);"name"===s&&e.setAttribute("name",n)}e.__listeners||(Object.defineProperty(e,"__listeners",{value:new Listeners(e)}),e.__listeners.connect()),e.__listeners.setPropListeners(t,e)};function _initProtoStyle(e){const t=e[0].constructor.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();for(let s=e.length;s--;){let n=e[s].constructor.Style;const i=e[s].constructor.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();if(n){n.match(new RegExp(/([^,{}]+)(,(?=[^}]*{)|\s*{)/,"g")).map(e=>{(e=e.trim()).startsWith("@")||e.startsWith(":host")||e.startsWith("from")||e.startsWith("to")||e.startsWith("/*")||e.startsWith("body")||console.warn(t+': CSS Selector not prefixed with ":host"! This will cause style leakage!')}),n=n.replace(new RegExp(":host","g"),t);const e=document.createElement("style");e.innerHTML=n,e.setAttribute("id","io-style_"+t+(i!==t?"_"+i:"")),document.head.appendChild(e)}}}const nodes={};let hashes={};const parseHashes=function(){return window.location.hash.substr(1).split("&").reduce(function(e,t){const s=t.split("=");return e[s[0]]=s[1],e},{})},getHashes=function(){hashes=window.location.hash.substr(1).split("&").reduce(function(e,t){const s=t.split("=");return e[s[0]]=s[1],e},{});for(let e in hashes)if(nodes[e]&&""!==nodes[e]){const t=hashes[e].replace(/%20/g," ");isNaN(t)?nodes[e].value="true"===t||"false"===t?JSON.parse(t):t:nodes[e].value=JSON.parse(t)}for(let e in nodes)nodes[e].hash&&!hashes[e]&&(nodes[e].value=nodes[e].defValue)},setHashes=function(e){let t="";for(let s in nodes)(nodes[s].hash||e)&&void 0!==nodes[s].value&&""!==nodes[s].value&&nodes[s].value!==nodes[s].defValue&&("string"==typeof nodes[s].value?t+=s+"="+nodes[s].value+"&":t+=s+"="+JSON.stringify(nodes[s].value)+"&");for(let e in hashes)e&&!nodes[e]&&(t+=e+"="+hashes[e]+"&");t=t.slice(0,-1),window.location.hash=t,window.location.hash||history.replaceState({},document.title,window.location.pathname+window.location.search)};window.addEventListener("hashchange",getHashes,!1),getHashes();class IoStorageNode extends IoNode{static get Properties(){return{key:String,value:void 0,defValue:void 0,hash:Boolean}}constructor(e,t){if(super(e),this.defValue=t,this.hash)if(void 0!==hashes[this.key]){const e=hashes[this.key].replace(/%20/g," ");try{this.value=JSON.parse(e)}catch(t){this.value=e}}else this.value=t;else{const e="/"!==window.location.pathname?window.location.pathname+this.key:this.key,s=localStorage.getItem(e);this.value=null!=s?JSON.parse(s):t}}valueChanged(){if(this.hash)setHashes();else{const e="/"!==window.location.pathname?window.location.pathname+this.key:this.key;null===this.value||void 0===this.value?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(this.value))}}}function IoStorage(e,t,s){return nodes[e]||(nodes[e]=new IoStorageNode({key:e,hash:s},t),nodes[e].binding=nodes[e].bind("value"),nodes[e].connect(window)),nodes[e].binding}IoStorageNode.Register();export{Binding,IoElement,IoNode,IoNodeMixin,IoStorage,html};