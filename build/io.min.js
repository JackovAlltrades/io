class Prototypes extends Array{constructor(e){super();let t=e.prototype;for(;t&&t.constructor!==HTMLElement&&t.constructor!==Object;)this.push(t),t=t.__proto__}}const illegalPropNames=["style","className","listeners"];class ProtoProperties{constructor(e){const t={};for(let o=e.length;o--;){let s=e[o].constructor.properties;for(let e in s){-1!==illegalPropNames.indexOf(e)&&console.warn("Illegal property name:",e);let o=new Property(s[e],!0);t[e]?t[e].assign(o):t[e]=o}}for(let e in t)this[e]=new Property(t[e])}clone(){let e=new ProtoProperties([]);for(let t in this)e[t]=this[t].clone();return e}}function defineProperties(e){for(let t in e.__props){const o=t+"Changed",s=t+"-changed",i="_"!==t.charAt(0),n=!(!1===e.__props[t].enumerable);Object.defineProperty(e,t,{get:function(){return this.__props[t].value},set:function(e){if(this.__props[t].value===e)return;const n=this.__props[t].value;this.__props[t].value=e,this.__props[t].reflect&&this.setAttribute(t,this.__props[t].value),i&&(this[o]&&this[o](e,n),this.__props[t].observer&&this[this.__props[t].observer](e,n),this.changed(),this.dispatchEvent(s,{property:t,value:e,oldValue:n}))},enumerable:n&&i,configurable:!0})}}class Property{constructor(e){null===e||void 0===e?e={value:e}:"function"==typeof e?e={type:e}:"object"!=typeof e&&(e={value:e,type:e.constructor}),this.value=e.value,this.type=e.type,this.observer=e.observer,this.reflect=e.reflect,this.binding=e.binding,this.config=e.config,this.enumerable=void 0===e.enumerable||e.enumerable}assign(e){void 0!==e.value&&(this.value=e.value),void 0!==e.type&&(this.type=e.type),void 0!==e.observer&&(this.observer=e.observer),void 0!==e.reflect&&(this.reflect=e.reflect),void 0!==e.binding&&(this.binding=e.binding),void 0!==e.config&&(this.config=e.config),void 0!==e.enumerable&&(this.enumerable=e.enumerable)}clone(){let e=new Property(this);return void 0===e.value&&e.type&&(e.type===Boolean?e.value=!1:e.type===String?e.value="":e.type===Number?e.value=0:e.type===Array?e.value=[]:e.type===Object?e.value={}:e.type!==HTMLElement&&e.type!==Function&&(e.value=new e.type)),e}}class ProtoListeners{constructor(e){for(let t=e.length;t--;){let o=e[t].constructor.listeners;for(let e in o)this[e]=o[e]}}connect(e){for(let t in this)e.addEventListener(t,e[this[t]])}disconnect(e){for(let t in this)e.removeEventListener(t,e[this[t]])}}class ProtoFunctions extends Array{constructor(e){super();for(let t=e.length;t--;){let o=Object.getOwnPropertyNames(e[t]);for(let s=0;s<o.length;s++)"constructor"!==o[s]&&"function"==typeof e[t][o[s]]&&"anonymous"!==e[t][o[s]].name&&(-1===this.indexOf(o[s])&&this.push(o[s]),"value"===o[s]&&console.log(e[t][o[s]]))}}bind(e){for(let t=0;t<this.length;t++)e[this[t]]=e[this[t]].bind(e)}}class Binding{constructor(e,t){this.source=e,this.sourceProp=t,this.targets=[],this.targetsMap=new WeakMap,this.updateSource=this.updateSource.bind(this),this.updateTargets=this.updateTargets.bind(this),this.setSource(this.source)}setSource(){this.source.addEventListener(this.sourceProp+"-changed",this.updateTargets);for(let e=this.targets.length;e--;){let t=this.targetsMap.get(this.targets[e]);for(let o=t.length;o--;)this.targets[e].__props[t[o]].value=this.source[this.sourceProp]}}setTarget(e,t){if(-1===this.targets.indexOf(e)&&this.targets.push(e),this.targetsMap.has(e)){let o=this.targetsMap.get(e);-1===o.indexOf(t)&&(o.push(t),e.addEventListener(t+"-changed",this.updateSource))}else this.targetsMap.set(e,[t]),e.addEventListener(t+"-changed",this.updateSource)}removeTarget(e,t){if(this.targetsMap.has(e)){let o=this.targetsMap.get(e),s=o.indexOf(t);-1!==s&&o.splice(s,1),0===o.length&&this.targets.splice(this.targets.indexOf(e),1),e.removeEventListener(t+"-changed",this.updateSource)}}updateSource(e){if(-1===this.targets.indexOf(e.target))return;let t=e.detail.value;this.source[this.sourceProp]!==t&&(this.source[this.sourceProp]=t)}updateTargets(e){if(e.target!=this.source)return;let t=e.detail.value;for(let e=this.targets.length;e--;){let o=this.targetsMap.get(this.targets[e]);for(let s=o.length;s--;){let i=this.targets[e][o[s]];if(i!==t){if("number"==typeof t&&"number"==typeof i&&isNaN(t)&&isNaN(i))continue;this.targets[e][o[s]]=t}}}}}class PropListeners{setListeners(e){for(let t in e)t.startsWith("on-")&&(this[t.slice(3,t.length)]=e[t])}connect(e){for(let t in this){let o="function"==typeof this[t]?this[t]:e[this[t]];e.addEventListener(t,o)}}disconnect(e){for(let t in this){let o="function"==typeof this[t]?this[t]:e[this[t]];e.removeEventListener(t,o)}}}const IoCore=e=>(class extends e{static get properties(){return{id:{type:String,enumerable:!1}}}constructor(e={}){super(),Object.defineProperty(this,"__bindings",{value:{}}),Object.defineProperty(this,"__listeners",{value:{}}),Object.defineProperty(this,"__observeQueue",{value:[]}),Object.defineProperty(this,"__notifyQueue",{value:[]}),Object.defineProperty(this,"__props",{value:this.__props.clone()}),Object.defineProperty(this,"$",{value:{}}),this.__protoFunctions.bind(this),Object.defineProperty(this,"__propListeners",{value:new PropListeners}),this.__propListeners.setListeners(e),this.setProperties(e),-1===this.__observeQueue.indexOf("changed")&&this.__observeQueue.push("changed")}changed(){}dispose(){this.__protoListeners.disconnect(this),this.__propListeners.disconnect(this),this.removeListeners();for(let e in this.__props)this.__props[e].binding&&(this.__props[e].binding.removeTarget(this,e),delete this.__props[e].binding)}bind(e){return this.__bindings[e]=this.__bindings[e]||new Binding(this,e),this.__bindings[e]}set(e,t){let o=this[e];this[e]=t,o!==t&&this.dispatchEvent(e+"-set",{value:t,oldValue:o},!1)}setProperties(e){for(let t in e){if(void 0===this.__props[t])continue;let o,s,i=this.__props[t].binding,n=this.__props[t].value;e[t]instanceof Binding?(o=e[t],s=e[t].source[e[t].sourceProp]):s=e[t],this.__props[t].binding=o,this.__props[t].value=s,s!==n&&(this.__props[t].reflect&&this.setAttribute(t,s),this.queue(this.__props[t].observer,t,s,n),this.__props[t].observer&&this.queue(this.__props[t].observer,t,s,n),this.queue(t+"Changed",t,s,n)),o!==i&&(o&&o.setTarget(this,t),i&&i.removeTarget(this,t))}if(e.className&&(this.className=e.className),e.style)for(let t in e.style)this.style[t]=e.style[t],this.style.setProperty(t,e.style[t])}objectMutated(e){for(let t=this.__objectProps.length;t--;)this.__props[this.__objectProps[t]].value===e.detail.object&&this.changed()}connectedCallback(){this.__protoListeners.connect(this),this.__propListeners.connect(this),this.queueDispatch();for(let e in this.__props)this.__props[e].binding&&this.__props[e].binding.setTarget(this,e);this.__objectProps.length&&window.addEventListener("io-object-mutated",this.objectMutated)}disconnectedCallback(){this.__protoListeners.disconnect(this),this.__propListeners.disconnect(this);for(let e in this.__props)this.__props[e].binding&&this.__props[e].binding.removeTarget(this,e);this.__objectProps.length&&window.removeEventListener("io-object-mutated",this.objectMutated)}addEventListener(t,o){this.__listeners[t]=this.__listeners[t]||[],-1===this.__listeners[t].indexOf(o)&&(e===HTMLElement&&HTMLElement.prototype.addEventListener.call(this,t,o),this.__listeners[t].push(o))}hasEventListener(e,t){return void 0!==this.__listeners[e]&&-1!==this.__listeners[e].indexOf(t)}removeEventListener(t,o){if(void 0!==this.__listeners[t]){let s=this.__listeners[t].indexOf(o);-1!==s&&(e===HTMLElement&&HTMLElement.prototype.removeEventListener.call(this,t,o),this.__listeners[t].splice(s,1))}}removeListeners(){for(let t in this.__listeners)for(let o=this.__listeners[t].length;o--;)e===HTMLElement&&HTMLElement.prototype.removeEventListener.call(this,t,this.__listeners[t][o]),this.__listeners[t].splice(o,1)}dispatchEvent(e,t={},o=!0,s=this){if(s instanceof HTMLElement||s===window)HTMLElement.prototype.dispatchEvent.call(s,new CustomEvent(e,{type:e,detail:t,bubbles:o,composed:!0}));else{let i=[s];if(void 0!==this.__listeners[e]){let s=this.__listeners[e].slice(0);for(let n=0,r=s.length;n<r;n++){const r={detail:t,target:this,bubbles:o,path:i=i||[this]};if(s[n].call(this,r),o){let o=this.parent;for(;o;)i.push(o),o.dispatchEvent(e,t,!0,i),o=o.parent}}}}}queue(e,t,o,s){"number"==typeof o&&"number"==typeof s&&isNaN(o)&&isNaN(s)||(e&&this[e]&&-1===this.__observeQueue.indexOf(e)&&this.__observeQueue.push(e),this.__notifyQueue.push([t+"-changed",{value:o,oldValue:s}]))}queueDispatch(){(this.__observeQueue.length||this.__notifyQueue.length)&&this.__observeQueue.push("changed");for(let e=0;e<this.__observeQueue.length;e++)this[this.__observeQueue[e]]();for(let e=0;e<this.__notifyQueue.length;e++)this.dispatchEvent(this.__notifyQueue[e][0],this.__notifyQueue[e][1]);this.__observeQueue.length=0,this.__notifyQueue.length=0}});IoCore.Register=function(){Object.defineProperty(this.prototype,"__prototypes",{value:new Prototypes(this)}),Object.defineProperty(this.prototype,"__props",{value:new ProtoProperties(this.prototype.__prototypes)}),Object.defineProperty(this.prototype,"__protoFunctions",{value:new ProtoFunctions(this.prototype.__prototypes)}),Object.defineProperty(this.prototype,"__protoListeners",{value:new ProtoListeners(this.prototype.__prototypes)}),Object.defineProperty(this.prototype,"__objectProps",{value:[]});const e=[Boolean,String,Number,HTMLElement,Function];for(let t in this.prototype.__props){let o=this.prototype.__props[t].type;-1==e.indexOf(o)&&this.prototype.__objectProps.push(t)}defineProperties(this.prototype)};class IoNode extends(IoCore(Object)){connect(){this.connectedCallback()}disconnect(){this.disconnectedCallback()}dispose(){delete this.parent,this.children.lenght=0;for(let e in this.__listeners)this.__listeners[e].lenght=0;for(let e in this.__props)delete this.__props[e]}}IoNode.Register=function(){IoCore.Register.call(this)},IoNode.Register();class IoElement extends(IoCore(HTMLElement)){static get properties(){return{tabindex:{type:String,reflect:!0,enumerable:!1},contenteditable:{type:Boolean,reflect:!0,enumerable:!1}}}connectedCallback(){super.connectedCallback();for(let e in this.__props)this.__props[e].reflect&&this.setAttribute(e,this.__props[e].value)}template(e,t){this.traverse(buildTree()(["root",e]).children,t||this)}traverse(e,t){const o=t.children;for(;o.length>e.length;){let e=o[o.length-1],s=Array.from(e.querySelectorAll("*"));for(let e=s.length;e--;)s[e].dispose&&s[e].dispose();t.removeChild(e)}const s=document.createDocumentFragment();for(let t=o.length;t<e.length;t++)s.appendChild(constructElement(e[t]));t.appendChild(s);for(let s=0;s<o.length;s++)if(o[s].localName!==e[s].name){const i=o[s];t.insertBefore(constructElement(e[s]),i),t.removeChild(i)}else if(o[s].hasOwnProperty("__props"))o[s].setProperties(e[s].props),o[s].queueDispatch(),o[s].__propListeners.setListeners(e[s].props),o[s].__propListeners.connect(o[s]);else{for(let t in e[s].props)if("style"===t)for(let i in e[s].props.style)o[s].style.setProperty(i,e[s].props[t][i]);else o[s][t]=e[s].props[t];o[s].__propListeners.setListeners(e[s].props),o[s].__propListeners.connect(o[s])}for(let t=0;t<e.length;t++)e[t].props.id&&(this.$[e[t].props.id]=o[t]),e[t].children&&"string"==typeof e[t].children?o[t].innerText=e[t].children:e[t].children&&"object"==typeof e[t].children&&this.traverse(e[t].children,o[t])}setAttribute(e,t){!0===t?HTMLElement.prototype.setAttribute.call(this,e,""):!1===t||""===t?this.removeAttribute(e):"string"!=typeof t&&"number"!=typeof t||this.getAttribute(e)!==String(t)&&HTMLElement.prototype.setAttribute.call(this,e,t)}static get observedAttributes(){return this.prototype.__observedAttributes}attributeChangedCallback(e,t,o){const s=this.__props[e].type;s===Boolean?null!==o&&""!==o||(this[e]=""===o):s&&(this[e]=s(o))}}function html(){return arguments[0][0]}IoElement.Register=function(){IoCore.Register.call(this);const e=this.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();Object.defineProperty(this,"localName",{value:e}),Object.defineProperty(this.prototype,"localName",{value:e}),Object.defineProperty(this.prototype,"__observedAttributes",{value:[]});for(let e in this.prototype.__props)this.prototype.__props[e].reflect&&this.prototype.__observedAttributes.push(e);customElements.define(e,this),initStyle(this.prototype.__prototypes)},IoElement.Register();const constructElement=function(e){let t=customElements.get(e.name);if(t)return new t(e.props);let o=document.createElement(e.name);for(let t in e.props)if("style"===t)for(let s in e.props[t])o.style[s]=e.props[t][s];else o[t]=e.props[t];return Object.defineProperty(o,"__propListeners",{value:new PropListeners}),o.__propListeners.setListeners(e.props),o.__propListeners.connect(o),o},clense=(e,t)=>t?"string"==typeof t[0]?[...e,t]:[...e,...t]:e,buildTree=()=>e=>e&&"object"==typeof e[1]&&!Array.isArray(e[1])?{name:e[0],props:e[1],children:Array.isArray(e[2])?e[2].reduce(clense,[]).map(buildTree()):e[2]||""}:buildTree()([e[0],{},e[1]||""]),_stagingElement=document.createElement("div");function initStyle(e){let t=e[0].constructor.name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();for(let o=e.length;o--;){let s=e[o].constructor.style;if(s){if(o<e.length-1&&s==e[o+1].constructor.style)continue;s=s.replace(new RegExp(":host","g"),t),_stagingElement.innerHTML=s;let i=_stagingElement.querySelector("style");i.setAttribute("id","io-style-"+t+"-"+o),document.head.appendChild(i)}}}const nodes={};class StoreNode extends IoNode{static get properties(){return{key:String,value:void 0}}constructor(e){super(e);const t=localStorage.getItem(this.key);null!==t&&(this.value=JSON.parse(t))}valueChanged(){localStorage.setItem(this.key,this.value)}}function storage(e,t){let o=nodes[e];return o||(o=new StoreNode({key:e}),nodes[e]=o,o.connect(),o.binding=o.bind("value")),void 0===o.value&&void 0!==t&&(o.value=t),o.binding}StoreNode.Register();const _clickmask=document.createElement("div");_clickmask.style="position: fixed; top:0; left:0; bottom:0; right:0; z-index:2147483647;";let _mousedownPath=null;class Vector2{constructor(e={}){this.x=e.x||0,this.y=e.y||0}set(e){return this.x=e.x,this.y=e.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}distanceTo(e){let t=this.x-e.x,o=this.y-e.y;return Math.sqrt(t*t+o*o)}}class Pointer{constructor(e={}){this.position=new Vector2(e.position),this.previous=new Vector2(e.previous),this.movement=new Vector2(e.movement),this.distance=new Vector2(e.distance),this.start=new Vector2(e.start)}getClosest(e){let t=e[0];for(let o=1;o<e.length;o++)this.position.distanceTo(e[o].position)<this.position.distanceTo(t.position)&&(t=e[o]);return t}changed(e){this.previous.set(this.position),this.movement.set(e.position).sub(this.position),this.distance.set(e.position).sub(this.start),this.position.set(e.position)}}const IoInteractiveMixin=e=>(class extends e{static get properties(){return{pointers:Array,pointermode:"relative",cursor:"all-scroll"}}static get listeners(){return{mousedown:"_onMousedown",touchstart:"_onTouchstart",mousemove:"_onMousehover"}}constructor(e){super(e),this._clickmask=_clickmask}getPointers(e,t){let o=e.touches?e.touches:[e],s=[],i=this.getBoundingClientRect();for(let n=0;n<o.length;n++)if(o[n].target===e.target||void 0===e.touches){let e=new Vector2({x:o[n].clientX,y:o[n].clientY});"relative"===this.pointermode?(e.x-=i.left,e.y-=i.top):"viewport"===this.pointermode&&(e.x=(e.x-i.left)/i.width*2-1,e.y=(e.y-i.top)/i.height*2-1),void 0===this.pointers[n]&&(this.pointers[n]=new Pointer({start:e}));let r=new Pointer({position:e}),l=r.getClosest(this.pointers);t&&l.start.set(e),l.changed(r),s.push(l)}for(let e=this.pointers.length;e--;)-1===s.indexOf(this.pointers[e])&&this.pointers.splice(e,1)}_onMousedown(e){_mousedownPath=e.composedPath(),this.getPointers(e,!0),this._fire("io-pointer-start",e,this.pointers),window.addEventListener("mousemove",this._onMousemove),window.addEventListener("mouseup",this._onMouseup),window.addEventListener("blur",this._onMouseup),_clickmask.parentNode!==document.body&&(document.body.appendChild(_clickmask),_clickmask.style.setProperty("cursor",this.cursor))}_onMousemove(e){this.getPointers(e),this._fire("io-pointer-move",e,this.pointers,_mousedownPath)}_onMouseup(e){this.getPointers(e),this._fire("io-pointer-end",e,this.pointers,_mousedownPath),window.removeEventListener("mousemove",this._onMousemove),window.removeEventListener("mouseup",this._onMouseup),window.removeEventListener("blur",this._onMouseup),_clickmask.parentNode===document.body&&(document.body.removeChild(_clickmask),_clickmask.style.setProperty("cursor",null))}_onMousehover(e){this.getPointers(e),this._fire("io-pointer-hover",e,this.pointers)}_onTouchstart(e){this.getPointers(e,!0),this._fire("io-pointer-hover",e,this.pointers),this._fire("io-pointer-start",e,this.pointers),this.addEventListener("touchmove",this._onTouchmove),this.addEventListener("touchend",this._onTouchend)}_onTouchmove(e){this.getPointers(e),this._fire("io-pointer-move",e,this.pointers)}_onTouchend(e){this.removeEventListener("touchmove",this._onTouchmove),this.removeEventListener("touchend",this._onTouchend),this._fire("io-pointer-end",e,this.pointers)}_fire(e,t,o,s){s=s||t.composedPath(),this.dispatchEvent(e,{event:t,pointer:o,path:s},!1)}});class IoInteractive extends(IoInteractiveMixin(IoElement)){}IoInteractive.Register();const IoLiteMixin=e=>(class extends e{addEventListener(e,t){this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)}hasEventListener(e,t){return void 0!==this._listeners&&(void 0!==this._listeners[e]&&-1!==this._listeners[e].indexOf(t))}removeEventListener(e,t){if(void 0!==this._listeners&&void 0!==this._listeners[e]){let o=this._listeners[e].indexOf(t);-1!==o&&this._listeners[e].splice(o,1)}}dispatchEvent(e,t={}){const o={path:[this],target:this,detail:t};if(this._listeners&&void 0!==this._listeners[e]){const t=this._listeners[e].slice(0);for(let e=0,s=t.length;e<s;e++)t[e].call(this,o)}}defineProperties(e){this.hasOwnProperty("_properties")||Object.defineProperty(this,"_properties",{value:{},enumerable:!1});for(let t in e){let o=e[t];null===o||void 0===o?o={value:o}:"object"!=typeof o?o={value:o}:"object"==typeof o&&"Object"!==o.constructor.name?o={value:o}:"object"==typeof o&&void 0===o.value&&(o={value:o}),defineProperty(this,t,o)}}}),defineProperty=function(e,t,o){const s=t+"Changed",i=t+"-changed",n="_"!==t.charAt(0),r=!(!1===o.enumerable);e._properties[t]=o.value,e.hasOwnProperty(t)||Object.defineProperty(e,t,{get:function(){return e._properties[t]},set:function(r){if(e._properties[t]===r)return;const l=e._properties[t];e._properties[t]=r,n&&(o.observer&&e[o.observer](r,l),"function"==typeof e[s]&&e[s](r,l),"function"==typeof e.changed&&e.changed.call(e),e.dispatchEvent(i,{property:t,value:r,oldValue:l,bubbles:!0}))},enumerable:r&&n,configurable:!0}),e[t]=o.value};class IoLite extends(IoLiteMixin(Object)){}class IoObjectProps extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;flex: 0 0;line-height: 1em;}:host > div.io-object-group {font-weight: bold;}:host > div.io-object-prop {display: flex !important;flex-direction: row;}:host > div > span {padding: 0 0.2em 0 0.5em;flex: 0 0 auto;}:host > div > io-number,:host > div > io-string,:host > div > io-boolean {border: none;background: none;margin: 0;padding: 0;}:host > div > io-number {color: rgb(28, 0, 207);}:host > div > io-string {color: rgb(196, 26, 22);}:host > div > io-boolean {color: rgb(170, 13, 145);}:host > div > io-option {color: rgb(32,135,0);}</style>`}static get properties(){return{value:Object,config:Object,props:Array,_config:Object}}connectedCallback(){super.connectedCallback(),window.addEventListener("io-object-mutated",this._onIoObjectMutated)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("io-object-mutated",this._onIoObjectMutated)}_onIoObjectMutated(e){let t=e.detail.key;if(e.detail.object===this.value)if(t&&this.$[t])this.$[t].__props.value.value=this.value[t],this.$[t].changed();else if(!t||"*"===t)for(let e in this.$)this.$[e].__props.value.value=this.value[e],this.$[e].changed()}_onValueSet(e){const t=e.composedPath();if(t[0]===this)return;if(e.detail.object)return;e.stopPropagation();let o=t[0].id;if(null!==o){this.value[o]=e.detail.value;let t=Object.assign({object:this.value,key:o},e.detail);this.dispatchEvent("io-object-mutated",t,!1,window),this.dispatchEvent("value-set",t,!1)}}changed(){const e=this.config,t=[];for(let o in e)if((!this.props.length||-1!==this.props.indexOf(o))&&e[o]){const s=e[o][0],i=e[o][1],n={id:o,value:this.value[o],"on-value-set":this._onValueSet};t.push(["div",{className:"io-object-prop"},[["span",e[o].label||o+":"],[s,Object.assign(n,i)]]])}this.template(t)}}IoObjectProps.Register();class IoCollapsable extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;border: 1px solid #999;border-radius: 3px;background: #ccc;}:host > io-boolean {border: none;border-radius: 0;background: none;}:host > io-boolean::before {content: '▸';display: inline-block;width: 0.65em;margin: 0 0.25em;}:host[expanded] > io-boolean::before{content: '▾';}:host > :nth-child(2) {display: block;border: 1px solid #999;border-radius: 3px;padding: 2px;background: #eee;}</style>`}static get properties(){return{label:String,expanded:{type:Boolean,reflect:!0},elements:Array}}changed(){this.template([["io-boolean",{true:this.label,false:this.label,value:this.bind("expanded")}],this.expanded?["div",this.elements]:null])}}IoCollapsable.Register();class IoObject extends IoCollapsable{static get properties(){return{value:Object,props:Array,config:Object,_config:Object}}valueChanged(){this._config=this.__proto__.__configs.getConfig(this.value,this.config)}configChanged(){this._config=this.__proto__.__configs.getConfig(this.value,this.config)}changed(){const e=this.label||this.value.constructor.name;this.template([["io-boolean",{true:e,false:e,value:this.bind("expanded")}],this.expanded?[["io-object-props",{value:this.value,props:this.props.length?this.props:Object.keys(this._config),config:this._config}]]:null])}static get config(){return{Object:{"type:string":["io-string",{}],"type:number":["io-number",{step:.01}],"type:boolean":["io-boolean",{}],"type:object":["io-object",{}],"value:null":["io-string",{}],"value:undefined":["io-string",{}]},Array:{"type:number":["io-number",{step:.1}]}}}}class Config{constructor(e){for(let t=0;t<e.length;t++){const o=e[t].constructor.config||{};for(let e in o)this[e]=this[e]||{},this.extend(this[e],o[e])}}extend(e,t){for(let o in t)e[o]=e[o]||[],e[o]=[e[o][0]||t[o][0],Object.assign(e[o][1]||{},t[o][1]||{})]}getConfig(e,t={}){const o=Object.keys(e),s=[];let i=e.__proto__;for(;i;)o.push(...Object.keys(i)),s.push(i.constructor.name),i=i.__proto__;const n={};for(let e=s.length;e--;)this.extend(n,this[s[e]]);this.extend(n,t);const r={};for(let t=0;t<o.length;t++){const s=o[t],i=e[s],l=typeof i,h="type:"+l,a="constructor:"+(i&&i.constructor?i.constructor.name:"null"),p=s,c="value:"+String(i);"function"!=l&&(r[s]={},n[h]&&(r[s]=n[h]),n[a]&&(r[s]=n[a]),n[p]&&(r[s]=n[p]),n[c]&&(r[s]=n[c]))}return r}}IoObject.Register=function(){IoElement.Register.call(this),Object.defineProperty(this.prototype,"__configs",{value:new Config(this.prototype.__prototypes)})},IoObject.Register();class IoArray extends IoObject{static get style(){return html`<style>:host {display: grid;}:host > io-number {/* margin: 1px;padding: 0.1em 0.2em; */}:host[columns="2"] {grid-template-columns: 50% 50%;}:host[columns="3"] {grid-template-columns: 33.3% 33.3% 33.3%;}:host[columns="4"] {grid-template-columns: 25% 25% 25% 25%;}:host[columns="5"] {grid-template-columns: 20% 20% 20% 20% 20%;}</style>`}static get properties(){return{columns:{value:0}}}changed(){const e=[];this.setAttribute("columns",this.columns||Math.sqrt(this.value.length)||1);for(let t=0;t<this.value.length;t++)e.push(["io-number",{id:t,value:this.value[t],"on-value-set":this._onValueSet}]);this.template(e)}}IoArray.Register();class IoButton extends IoElement{static get style(){return html`<style>:host {display: inline-block;cursor: pointer;white-space: nowrap;-webkit-tap-highlight-color: transparent;border: 1px solid #444;border-radius: 2px;padding: 0 0.25em;background: #ccc;}:host:focus {outline: none;border-color: #09d;background: #def;}:host:hover {background: #aaa;}:host[pressed] {background: rgba(255,255,255,0.5);}</style>`}static get properties(){return{value:void 0,label:"Button",pressed:{type:Boolean,reflect:!0},action:Function,tabindex:0}}static get listeners(){return{keydown:"_onDown",mousedown:"_onDown",touchstart:"_onDown"}}_onDown(e){e.stopPropagation(),13!==e.which&&32!==e.which&&"keydown"===e.type||(e.preventDefault(),this.pressed=!0,document.addEventListener("mouseup",this._onUp),document.addEventListener("touchend",this._onUp),this.addEventListener("keyup",this._onAction),this.addEventListener("mouseup",this._onAction),this.addEventListener("touchend",this._onAction),this.addEventListener("mouseleave",this._onLeave))}_onUp(e){e.stopPropagation(),this.pressed=!1,document.removeEventListener("mouseup",this._onUp),document.removeEventListener("touchend",this._onUp),this.removeEventListener("keyup",this._onAction),this.removeEventListener("mouseup",this._onAction),this.removeEventListener("touchend",this._onAction),this.removeEventListener("mouseleave",this._onLeave)}_onAction(e){e.stopPropagation(),13!==e.which&&32!==e.which&&"keyup"===e.type||(e.preventDefault(),this.pressed&&this.action&&this.action(this.value),this.pressed=!1,this.dispatchEvent("io-button-clicked",{value:this.value,action:this.action})),this._onUp(e)}_onLeave(){this.pressed=!1}changed(){this.innerText=this.label}}IoButton.Register();class IoBoolean extends IoButton{static get style(){return html`<style>:host {background: white;}</style>`}static get properties(){return{value:{type:Boolean,reflect:!0},true:"true",false:"false"}}constructor(e){super(e),this.action=this.toggle}toggle(){this.set("value",!this.value)}changed(){this.innerText=this.value?this.true:this.false}}IoBoolean.Register();class IoInspectorBreadcrumbs extends IoElement{static get style(){return html`<style>:host {display: flex;flex: 1 0;flex-direction: row;padding: 0 0.25em;background: #fff;border: 1px solid #999;border-radius: 2px;}:host > io-inspector-link {border: none;overflow: hidden;text-overflow: ellipsis;background: none;padding: 0;}:host > io-inspector-link:first-of-type,:host > io-inspector-link:last-of-type {overflow: visible;text-overflow: clip;}:host > io-inspector-link:not(:first-of-type):before {content: '/';margin: 0 0.1em;opacity: 0.25;}</style>`}static get properties(){return{crumbs:Array}}changed(){this.template([this.crumbs.map(e=>["io-inspector-link",{value:e}])])}}IoInspectorBreadcrumbs.Register();class IoInspectorLink extends IoButton{static get style(){return html`<style>:host {border: none;overflow: hidden;text-overflow: ellipsis;background: none;padding: 0;color: #15e;}:host:focus {outline: none;background: none;text-decoration: underline;}:host:hover {background: none;text-decoration: underline;}:host[pressed] {background: none;}</style>`}changed(){let e=this.value.constructor.name;this.value.name?e+=" ("+this.value.name+")":this.value.label&&(e+=" ("+this.value.label+")"),this.template([["span",e]])}}function isValueOfPropertyOf(e,t){for(let o in t)if(t[o]===e)return o;return null}IoInspectorLink.Register();class IoInspector extends IoObject{static get style(){return html`<style>:host {padding: 2px;background-color: #eee;}:host > io-inspector-breadcrumbs {margin-bottom: 2px;}:host > io-object {padding: 0 !important;font-size: 0.9em;background-color: #ccc !important;}:host > io-object > io-boolean {display: block;}:host > io-object > io-object-props {padding: 0 !important;margin: 2px;}:host > io-object > io-object-props > div {padding: 2px 0;}:host > io-object > io-object-props > div:not(:last-of-type) {border-bottom: 1px solid rgba(0, 0, 0, 0.5);}:host > io-object > io-object-props > div > :nth-child(1) {overflow: hidden;text-overflow: ellipsis;text-align: right;flex: 0 1 6em;padding-left: 0.5em;min-width: 3em;}:host > io-object > io-object-props > div > :nth-child(2) {flex: 1 0;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;min-width: 3em;}:host > io-object > io-object-props > div > io-inspector-link {flex: 0 0 auto !important;min-width: 0 !important;text-decoration: underline;color: #2233cc;}</style>`}static get properties(){return{crumbs:Array,groups:Object,_groups:Object}}static get listeners(){return{"io-button-clicked":"_onLinkClicked"}}_onLinkClicked(e){e.stopPropagation(),"io-inspector-link"===e.path[0].localName&&(this.value=e.detail.value)}valueChanged(){super.valueChanged(),this._groups=this.__proto__.__groups.getGroups(this.value,this.groups);let e=this.crumbs.find(e=>e===this.value),t=this.crumbs[this.crumbs.length-1];e?this.crumbs.length=this.crumbs.indexOf(e)+1:(t&&isValueOfPropertyOf(this.value,t)||(this.crumbs.length=0),this.crumbs.push(this.value)),this.crumbs=[...this.crumbs]}groupsChanged(){this._groups=this.__proto__.__groups.getGroups(this.value,this.groups)}changed(){const e=[["io-inspector-breadcrumbs",{crumbs:this.crumbs}]],t=this.value.guid||this.value.uuid||this.value.id,o=this.value.constructor.name;for(let s in this._groups){let i=!t||storage("io-inspector-group-"+o+"-"+t+"-"+s,!1);e.push(["io-object",{value:this.value,label:s,expanded:i,props:this._groups[s],config:this._config}])}this.template(e)}static get config(){return{Object:{"type:object":["io-inspector-link"],"type:boolean":["io-boolean",{true:"⦿ true",false:"⦾ false"}]}}}static get groups(){return{Object:{hidden:["constructor"]}}}}class Groups{constructor(e){for(let t=0;t<e.length;t++){const o=e[t].constructor.groups||{};for(let e in o)this[e]=this[e]||{},this.extend(this[e],o[e])}}extend(e,t){for(let o in t){e[o]=e[o]||[];for(let s=0;s<t[o].length;s++)-1===e[o].indexOf(t[o][s])&&e[o].push(t[o][s])}}getGroups(e,t={}){const o=Object.keys(e),s=[];let i=e.__proto__;for(;i;)o.push(...Object.keys(i)),s.push(i.constructor.name),i=i.__proto__;const n={};for(let e=s.length;e--;)this.extend(n,this[s[e]]);this.extend(n,t);const r={},l=[];for(let t=0;t<o.length;t++){const s=o[t],i=e[s],h=typeof i,a="type:"+h,p="constructor:"+(i&&i.constructor?i.constructor.name:"null"),c=s,u="value:"+String(i);if("function"!=h)for(let e in n)r[e]=r[e]||[],-1!==n[e].indexOf(a)&&(r[e].push(s),l.push(s)),-1!==n[e].indexOf(p)&&(r[e].push(s),l.push(s)),-1!==n[e].indexOf(c)&&(r[e].push(s),l.push(s)),-1!==n[e].indexOf(u)&&(r[e].push(s),l.push(s))}if(0===l.length)r.properties=o;else for(let e=0;e<o.length;e++)r.properties=r.properties||[],-1===l.indexOf(o[e])&&r.properties.push(o[e]);for(let e in r)0===r[e].length&&delete r[e];return delete r.hidden,r}}let previousOption,previousParent,timeoutOpen,timeoutReset;IoInspector.Register=function(){IoObject.Register.call(this),Object.defineProperty(this.prototype,"__groups",{value:new Groups(this.prototype.__prototypes)})},IoInspector.Register();let WAIT_TIME=1200;class IoMenuLayer extends IoElement{static get style(){return html`<style>:host {display: block;visibility: hidden;position: fixed;top: 0;left: 0;bottom: 0;right: 0;z-index: 100000;background: rgba(0, 0, 0, 0.2);user-select: none;overflow: hidden;pointer-events: none;}:host[expanded] {visibility: visible;pointer-events: all;}:host io-menu-options:not([expanded]) {display: none;}:host io-menu-options {padding: 0.125em 0 0.25em 0;border: 1px solid #666;box-shadow: 1px 1px 2px rgba(0,0,0,0.33);position: absolute;transform: translateZ(0);top: 0;left: 0;min-width: 6em;}</style>`}static get properties(){return{expanded:{type:Boolean,reflect:!0,observer:"_onScrollAnimateGroup"},$options:Array}}static get listeners(){return{mousedown:"_onMouseup",mousemove:"_onMousemove"}}constructor(e){super(e),this._hoveredItem=null,this._hoveredGroup=null,this._x=0,this._y=0,this._v=0,window.addEventListener("scroll",this._onScroll)}registerGroup(e){this.$options.push(e),e.addEventListener("focusin",this._onMenuItemFocused),e.addEventListener("mouseup",this._onMouseup),e.addEventListener("keydown",this._onKeydown),e.addEventListener("expanded-changed",this._onExpandedChanged)}unregisterGroup(e){this.$options.splice(this.$options.indexOf(e),1),e.removeEventListener("focusin",this._onMenuItemFocused),e.removeEventListener("mouseup",this._onMouseup),e.removeEventListener("keydown",this._onKeydown),e.removeEventListener("expanded-changed",this._onExpandedChanged)}collapseAllGroups(){for(let e=this.$options.length;e--;)this.$options[e].expanded=!1}runAction(e){"function"==typeof e.action?(e.action.apply(null,[e.value]),this.collapseAllGroups()):e.button&&(e.button.click(),this.collapseAllGroups())}_onScroll(){this.expanded&&this.collapseAllGroups()}_onMenuItemFocused(e){const t=e.composedPath()[0].optionschain;for(let e=this.$options.length;e--;)-1===t.indexOf(this.$options[e])&&(this.$options[e].expanded=!1)}_onTouchmove(e){this._onMousemove(e)}_onTouchend(e){this._onMouseup(e)}_onMousemove(e){this._x=e.clientX,this._y=e.clientY,this._v=(2*this._v+Math.abs(e.movementY)-Math.abs(e.movementX))/3;let t=this.$options;for(let e=t.length;e--;)if(t[e].expanded){let o=t[e].getBoundingClientRect();if(o.top<this._y&&o.bottom>this._y&&o.left<this._x&&o.right>this._x)return this._hover(t[e]),this._hoveredGroup=t[e],t[e]}this._hoveredItem=null,this._hoveredGroup=null}_onMouseup(e){let t=e.composedPath()[0];"io-menu-item"===t.localName?(this.runAction(t.option),t.menuroot.dispatchEvent("io-menu-item-clicked",t.option)):t===this&&(this._hoveredItem?(this.runAction(this._hoveredItem.option),this._hoveredItem.menuroot.dispatchEvent("io-menu-item-clicked",this._hoveredItem.option)):this._hoveredGroup||this.collapseAllGroups())}_onKeydown(e){e.preventDefault();const t=e.composedPath();if("io-menu-item"!==t[0].localName)return;let o=t[0],s=o.$parent,i=[...s.querySelectorAll("io-menu-item")]||[],n=o.$options?[...o.$options.querySelectorAll("io-menu-item")]:[],r=i.indexOf(o),l="";switch(s.horizontal?("ArrowUp"==e.key&&(l="out"),"ArrowRight"==e.key&&(l="next"),"ArrowDown"==e.key&&(l="in"),"ArrowLeft"==e.key&&(l="prev")):("ArrowUp"==e.key&&(l="prev"),"ArrowRight"==e.key&&(l="in"),"ArrowDown"==e.key&&(l="next"),"ArrowLeft"==e.key&&(l="out")),"Tab"==e.key&&(l="next"),"Escape"==e.key&&(l="exit"),"Enter"!=e.key&&32!=e.which||(l="action"),l){case"action":this._onMouseup(e);break;case"prev":i[(r+i.length-1)%i.length].focus();break;case"next":i[(r+1)%i.length].focus();break;case"in":n.length&&n[0].focus();break;case"out":s&&s.$parent&&s.$parent.focus();break;case"exit":this.collapseAllGroups()}}_hover(e){let t=e.querySelectorAll("io-menu-item");for(let o=t.length;o--;){let s=t[o].getBoundingClientRect();if(s.top<this._y&&s.bottom>this._y&&s.left<this._x&&s.right>this._x){let s=e.horizontal;return this._focus(t[o],s),this._hoveredItem=t[o],t[o]}}this._hoveredItem=null,this._hoveredItem=null}_focus(e,t){e!==previousOption&&(clearTimeout(timeoutOpen),clearTimeout(timeoutReset),this._v>1||e.parentNode!==previousParent||t?(previousOption=e,e.focus()):timeoutOpen=setTimeout(function(){previousOption=e,e.focus()}.bind(this),WAIT_TIME),previousParent=e.parentNode,timeoutReset=setTimeout(function(){previousOption=null,previousParent=null}.bind(this),WAIT_TIME+1))}_onExpandedChanged(e){const t=e.composedPath();t[0].expanded&&this._setGroupPosition(t[0]);for(let e=this.$options.length;e--;)if(this.$options[e].expanded)return this.expanded=!0;return this.expanded=!1}_setGroupPosition(e){if(!e.$parent)return;let t=e.getBoundingClientRect(),o=e.$parent.getBoundingClientRect();switch("bottom"===e.position&&t.height>window.innerHeight-this._y&&(e.position="right"),e.position){case"pointer":e._x=this._x-2||o.x,e._y=this._y-2||o.y;break;case"bottom":e._x=o.x,e._y=o.bottom;break;case"right":default:e._x=o.right,e._y=o.y,e._x+t.width>window.innerWidth&&(e._x=o.x-t.width)}e._x=Math.min(e._x,window.innerWidth-t.width),e._y=Math.min(e._y,window.innerHeight-t.height),e.style.left=e._x+"px",e.style.top=e._y+"px"}_onScrollAnimateGroup(){if(!this.expanded)return;let e=this._hoveredGroup;if(e){let t=e.getBoundingClientRect();if(t.height>window.innerHeight){if(this._y<100&&t.top<0){let o=(100-this._y)/5e3,s=t.top;e._y=e._y-Math.ceil(s*o)+1}else if(this._y>window.innerHeight-100&&t.bottom>window.innerHeight){let o=(100-(window.innerHeight-this._y))/5e3,s=t.bottom-window.innerHeight;e._y=e._y-Math.ceil(s*o)-1}e.style.left=e._x+"px",e.style.top=e._y+"px"}}requestAnimationFrame(this._onScrollAnimateGroup)}}IoMenuLayer.Register(),IoMenuLayer.singleton=new IoMenuLayer,document.body.appendChild(IoMenuLayer.singleton);class IoMenuItem$$1 extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: row;cursor: pointer;padding: 0.125em 0.5em 0.125em 1.7em;line-height: 1em;}:host > * {pointer-events: none;}:host > .menu-icon {width: 1.25em;margin-left: -1.25em;line-height: 1em;}:host > .menu-label {flex: 1}:host > .menu-hint {opacity: 0.5;padding: 0 0.5em;}:host > .menu-more {opacity: 0.5;margin: 0 -0.25em 0 0.25em;}</style>`}static get properties(){return{option:Object,position:String,$parent:HTMLElement,tabindex:1}}static get listeners(){return{focus:"_onFocus",touchstart:"_onTouchstart"}}get menuroot(){let e=this;for(;e&&e.$parent;)e=e.$parent;return e}get optionschain(){const e=[];this.$options&&e.push(this.$options);let t=this.$parent;for(;t;)"io-menu-options"==t.localName&&e.push(t),t=t.$parent;return e}changed(){if(this.option.options){let e={options:this.option.options,$parent:this,position:this.position};this.$options?this.$options.setProperties(e):this.$options=new IoMenuOptions(e)}this.template([this.option.icon?["span",{className:"menu-icon"},this.option.icon]:null,["span",{className:"menu-label"},this.option.label||this.option.value],this.option.hint?["span",{className:"menu-hint"}]:null,this.option.options?["span",{className:"menu-more"},"▸"]:null])}disconnectedCallback(){super.disconnectedCallback(),this.$options&&this.$options.parentNode&&IoMenuLayer.singleton.removeChild(this.$options)}_onTouchstart(e){e.preventDefault(),this.addEventListener("touchmove",this._onTouchmove),this.addEventListener("touchend",this._onTouchend),this.focus()}_onTouchmove(e){e.preventDefault(),IoMenuLayer.singleton._onTouchmove(e)}_onTouchend(e){e.preventDefault(),this.removeEventListener("touchmove",this._onTouchmove),this.removeEventListener("touchend",this._onTouchend),IoMenuLayer.singleton._onTouchend(e)}_onFocus(){this.$options&&(this.$options.parentNode||IoMenuLayer.singleton.appendChild(this.$options),this.$options.expanded=!0)}}IoMenuItem$$1.Register();class IoMenuOptions extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: column;white-space: nowrap;user-select: none;background: white;color: black;}:host[horizontal] {flex-direction: row;}:host[horizontal] > io-menu-item {padding: 0.25em 0.5em;}:host[horizontal] > io-menu-item > :not(.menu-label) {display: none;}</style>`}static get properties(){return{options:Array,expanded:{type:Boolean,reflect:!0},position:"right",horizontal:{type:Boolean,reflect:!0},$parent:HTMLElement}}static get listeners(){return{focusin:"_onFocus"}}optionsChanged(){const e=this.horizontal?"bottom":"right";this.template([this.options.map((t,o)=>["io-menu-item",{$parent:this,option:"object"==typeof this.options[o]?this.options[o]:{value:this.options[o],label:this.options[o]},position:e}])])}connectedCallback(){super.connectedCallback(),IoMenuLayer.singleton.registerGroup(this)}disconnectedCallback(){super.disconnectedCallback(),IoMenuLayer.singleton.unregisterGroup(this)}_onFocus(e){const t=e.composedPath()[0];IoMenuLayer.singleton._hoveredGroup=this,"io-menu-item"===t.localName&&(IoMenuLayer.singleton._hoveredItem=t,t.option.options&&(this.expanded=!0))}}IoMenuOptions.Register();class IoMenu extends IoElement{static get properties(){return{options:Array,expanded:Boolean,position:"pointer",listener:"click"}}constructor(e){super(e),this.template([["io-menu-options",{id:"group",$parent:this,options:this.bind("options"),position:this.bind("position"),expanded:this.bind("expanded")}]]),this.$.group.__parent=this}connectedCallback(){super.connectedCallback(),this._parent=this.parentElement,this._parent.addEventListener(this.listener,this._onExpand),IoMenuLayer.singleton.appendChild(this.$.group)}disconnectedCallback(){super.disconnectedCallback(),this._parent.removeEventListener(this.listener,this._onExpand),IoMenuLayer.singleton.removeChild(this.$.group)}getBoundingClientRect(){return this._parent.getBoundingClientRect()}_onExpand(e){e.preventDefault();let t=e.touches?e.touches[0]:e;IoMenuLayer.singleton.collapseAllGroups(),IoMenuLayer.singleton._x=t.clientX,IoMenuLayer.singleton._y=t.clientY,this.expanded=!0}}IoMenu.Register();const selection=window.getSelection(),range=document.createRange();class IoNumber extends IoElement{static get style(){return html`<style>:host {overflow: hidden;text-overflow: ellipsis;white-space: nowrap;border: 1px solid #444;border-radius: 2px;padding: 0 0.25em;background: white;}:host:focus {overflow: hidden;text-overflow: clip;outline: none;border-color: #09d;background: #def;}</style>`}static get properties(){return{value:Number,conversion:1,step:.001,min:-1/0,max:1/0,strict:!0,tabindex:0,contenteditable:!0}}static get listeners(){return{focus:"_onFocus"}}constructor(e){super(e),this.setAttribute("spellcheck","false")}_onFocus(){this.addEventListener("blur",this._onBlur),this.addEventListener("keydown",this._onKeydown),this._select()}_onBlur(){this.removeEventListener("blur",this._onBlur),this.removeEventListener("keydown",this._onKeydown),this.setFromText(this.innerText),this.scrollTop=0,this.scrollLeft=0}_onKeydown(e){13==e.which&&(e.preventDefault(),this.setFromText(this.innerText))}_select(){range.selectNodeContents(this),selection.removeAllRanges(),selection.addRange(range)}setFromText(e){let t=Math.round(Number(e)/this.step)*this.step/this.conversion;this.strict&&(t=Math.min(this.max,Math.max(this.min,t))),isNaN(t)||this.set("value",t)}changed(){let e=this.value;"number"!=typeof e||isNaN(e)?this.innerText="NaN":(e=(e*=this.conversion).toFixed(-Math.round(Math.log(this.step)/Math.LN10)),this.innerText=String(e))}}IoNumber.Register();class IoOption extends IoButton{static get style(){return html`<style>:host::after {width: 0.65em;margin-left: 0.25em;content: '▾';}</style>`}static get properties(){return{options:Array}}_onUp(e){super._onUp(e),this.$.menu.expanded=!0;let t=this.$.menu.$.group.querySelector("io-menu-item");t&&t.focus()}_onAction(e){13!=e.which&&32!=e.which&&"mouseup"!=e.type&&"touchend"!=e.type||e.preventDefault()}_onMenu(e){this.$.menu.expanded=!1,this.set("value",e.detail.value),"function"==typeof this.action&&this.action(this.value)}changed(){let e=this.value;if(e instanceof Object&&(e=e.__proto__.constructor.name),this.options)for(let t=0;t<this.options.length;t++)if(this.options[t].value===this.value){e=this.options[t].label||e;break}this.template([["span",String(e)],["io-menu",{id:"menu",options:this.options,position:"bottom",listener:"click","on-io-menu-item-clicked":this._onMenu}]])}}IoOption.Register();const canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");class IoSlider extends IoElement{static get style(){return html`<style>:host {display: flex;flex-direction: row;}:host > io-number {flex: 0 0 auto;/* margin: 1px; *//* padding: 0.1em 0.2em; */}:host > io-slider-knob {/* margin: 1px; */flex: 1 1 auto;margin-left: 0.05em;border: 1px solid #000;border-radius: 2px;padding: 0 1px;background: #999;}</style>`}static get properties(){return{value:0,step:.001,min:0,max:1,strict:!0}}changed(){const e=Math.max(Math.max(String(this.min).length,String(this.max).length),String(this.step).length);this.template([["io-number",{value:this.bind("value"),step:this.step,min:this.min,max:this.max,strict:this.strict,id:"number"}],["io-slider-knob",{value:this.bind("value"),step:this.step,min:this.min,max:this.max,strict:this.strict,id:"slider"}]]),this.$.number.style.setProperty("min-width",e+"em")}}IoSlider.Register();class IoSliderKnob extends(IoInteractiveMixin(IoElement)){static get style(){return html`<style>:host {display: flex;cursor: ew-resize;overflow: hidden;}:host img {width: 100% !important;}</style>`}static get properties(){return{value:0,step:.01,min:0,max:1e3,strics:!0,pointermode:"absolute",cursor:"ew-resize"}}static get listeners(){return{"io-pointer-move":"_onPointerMove"}}_onPointerMove(e){e.detail.event.preventDefault();let t=this.getBoundingClientRect(),o=(e.detail.pointer[0].position.x-t.x)/t.width,s=Math.max(0,Math.min(1,o)),i=this.min+(this.max-this.min)*s;i=Math.round(i/this.step)*this.step,i=Math.min(this.max,Math.max(this.min,Math.round(i/this.step)*this.step)),this.set("value",i)}changed(){this.template([["img",{id:"img"}]]),this.$.img.src=this.paint(this.$.img.getBoundingClientRect())}paint(e){canvas.width=e.width,canvas.height=e.height;const t=this.min,o=this.max,s=this.step,i=this.value;if(isNaN(i))return;const n=e.width,r=e.height;let l,h=Math.floor(t/s)*s;if((o-t)/s<n/3)for(;h<o-s;)h+=s,l=Math.floor(n*(h-t)/(o-t)),ctx.lineWidth=1,ctx.strokeStyle="#444",ctx.beginPath(),ctx.moveTo(l,0),ctx.lineTo(l,r),ctx.stroke();ctx.fillStyle="#444",ctx.fillRect(0,r/2-2,n,4),l=2+(n-4)*(i-t)/(o-t);const a=ctx.createLinearGradient(0,0,l,0);return a.addColorStop(0,"#2cf"),a.addColorStop(1,"#2f6"),ctx.fillStyle=a,ctx.fillRect(0,r/2-2,l,4),ctx.lineWidth=4,ctx.strokeStyle="#2f6",ctx.beginPath(),ctx.moveTo(l,0),ctx.lineTo(l,r),ctx.stroke(),canvas.toDataURL()}}IoSliderKnob.Register();const selection$1=window.getSelection(),range$1=document.createRange();class IoString extends IoElement{static get style(){return html`<style>:host {overflow: hidden;text-overflow: ellipsis;white-space: nowrap;border: 1px solid #444;border-radius: 2px;padding: 0 0.25em;background: white;}:host:focus {overflow: hidden;text-overflow: clip;outline: none;border-color: #09d;background: #def;}</style>`}static get properties(){return{value:String,tabindex:0,contenteditable:!0}}static get listeners(){return{focus:"_onFocus"}}_onFocus(){this.addEventListener("blur",this._onBlur),this.addEventListener("keydown",this._onKeydown),this._select()}_onBlur(){this.set("value",this.innerText),this.scrollTop=0,this.scrollLeft=0,this.removeEventListener("blur",this._onBlur),this.removeEventListener("keydown",this._onKeydown)}_onKeydown(e){13==e.which&&(e.preventDefault(),this.set("value",this.innerText))}_select(){range$1.selectNodeContents(this),selection$1.removeAllRanges(),selection$1.addRange(range$1)}valueChanged(){this.innerText=String(this.value).replace(new RegExp(" ","g")," ")}}IoString.Register();export{IoCore,IoNode,IoElement,html,storage,IoInteractive,IoInteractiveMixin,IoLite,IoLiteMixin,IoArray,IoBoolean,IoButton,IoCollapsable,IoInspector,IoMenuOptions,IoMenu,IoNumber,IoObject,IoOption,IoSlider,IoString};